"use strict";(self.webpackChunktemplate_docs=self.webpackChunktemplate_docs||[]).push([[1865],{11470:(e,t,n)=>{n.d(t,{A:()=>y});var r=n(96540),s=n(34164),o=n(23104),i=n(56347),a=n(205),c=n(57485),l=n(31682),d=n(70679);function u(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)(()=>{const e=t??function(e){return u(e).map(({props:{value:e,label:t,attributes:n,default:r}})=>({value:e,label:t,attributes:n,default:r}))}(n);return function(e){const t=(0,l.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function h({value:e,tabValues:t}){return t.some(t=>t.value===e)}function g({queryString:e=!1,groupId:t}){const n=(0,i.W6)(),s=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,c.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const t=new URLSearchParams(n.location.search);t.set(s,e),n.replace({...n.location,search:t.toString()})},[s,n])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,o=p(e),[i,c]=(0,r.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:o})),[l,u]=g({queryString:n,groupId:s}),[m,v]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,s]=(0,d.Dv)(t);return[n,(0,r.useCallback)(e=>{t&&s.set(e)},[t,s])]}({groupId:s}),x=(()=>{const e=l??m;return h({value:e,tabValues:o})?e:null})();(0,a.A)(()=>{x&&c(x)},[x]);return{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),v(e)},[u,v,o]),tabValues:o}}var v=n(92303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(74848);function j({className:e,block:t,selectedValue:n,selectValue:r,tabValues:i}){const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),l=e=>{const t=e.currentTarget,s=a.indexOf(t),o=i[s].value;o!==n&&(c(t),r(o))},d=e=>{let t=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},e),children:i.map(({value:e,label:t,attributes:r})=>(0,f.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:l,...r,className:(0,s.A)("tabs__item",x.tabItem,r?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function P({lazy:e,children:t,selectedValue:n}){const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===n);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function b(e){const t=m(e);return(0,f.jsxs)("div",{className:(0,s.A)("tabs-container",x.tabList),children:[(0,f.jsx)(j,{...t,...e}),(0,f.jsx)(P,{...t,...e})]})}function y(e){const t=(0,v.A)();return(0,f.jsx)(b,{...e,children:u(e.children)},String(t))}},15801:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"ecom-co/libs/grpc/docs/proto-utils","title":"Proto Utils \u2014 Shared Proto Files Management","description":"Utility module \u0111\u1ec3 share v\xe0 manage proto files trong gRPC library, h\u1ed7 tr\u1ee3 dynamic discovery v\xe0 custom proto paths.","source":"@site/docs/ecom-co/libs/grpc/docs/proto-utils.md","sourceDirName":"ecom-co/libs/grpc/docs","slug":"/proto-utils","permalink":"/document/docs/proto-utils","draft":false,"unlisted":false,"editUrl":"https://github.com/ecom-co/document/tree/main/docs/ecom-co/libs/grpc/docs/proto-utils.md","tags":[{"inline":true,"label":"grpc","permalink":"/document/docs/tags/grpc"},{"inline":true,"label":"proto","permalink":"/document/docs/tags/proto"},{"inline":true,"label":"protobuf","permalink":"/document/docs/tags/protobuf"},{"inline":true,"label":"utils","permalink":"/document/docs/tags/utils"},{"inline":true,"label":"shared","permalink":"/document/docs/tags/shared"},{"inline":true,"label":"library","permalink":"/document/docs/tags/library"}],"version":"current","frontMatter":{"id":"proto-utils","title":"Proto Utils \u2014 Shared Proto Files Management","sidebar_label":"Proto Utils","slug":"/proto-utils","description":"Utility module \u0111\u1ec3 share v\xe0 manage proto files trong gRPC library, h\u1ed7 tr\u1ee3 dynamic discovery v\xe0 custom proto paths.","tags":["grpc","proto","protobuf","utils","shared","library"]},"sidebar":"tutorialSidebar","previous":{"title":"gRPC Library","permalink":"/document/docs/ecom-co/libs/grpc/grpc-library"},"next":{"title":"WrappedGrpc","permalink":"/document/docs/wrapped-grpc"}}');var s=n(74848),o=n(28453),i=n(11470),a=n(19365);const c={id:"proto-utils",title:"Proto Utils \u2014 Shared Proto Files Management",sidebar_label:"Proto Utils",slug:"/proto-utils",description:"Utility module \u0111\u1ec3 share v\xe0 manage proto files trong gRPC library, h\u1ed7 tr\u1ee3 dynamic discovery v\xe0 custom proto paths.",tags:["grpc","proto","protobuf","utils","shared","library"]},l=void 0,d={},u=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:3},{value:"File Structure",id:"file-structure",level:3},{value:"API Reference",id:"api-reference",level:3},{value:"Functions",id:"functions",level:4},{value:"Constants",id:"constants",level:4},{value:"Usage Examples",id:"usage-examples",level:3},{value:"Customization Guide",id:"customization-guide",level:3},{value:"1. Clone v\xe0 Setup",id:"1-clone-v\xe0-setup",level:4},{value:"2. Th\xeam Proto Files M\u1edbi",id:"2-th\xeam-proto-files-m\u1edbi",level:4},{value:"3. Update Constants",id:"3-update-constants",level:4},{value:"4. Build v\xe0 Publish",id:"4-build-v\xe0-publish",level:4},{value:"Advanced Usage",id:"advanced-usage",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Migration Guide",id:"migration-guide",level:3},{value:"T\u1eeb Legacy Constants",id:"t\u1eeb-legacy-constants",level:4},{value:"Custom Proto Directory",id:"custom-proto-directory",level:4}];function p(e){const t={admonition:"admonition",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"Proto Utils"})," l\xe0 utility module \u0111\u1ec3 share proto files gi\u1eefa c\xe1c services, qu\u1ea3n l\xfd proto file paths v\xe0 h\u1ed7 tr\u1ee3 dynamic discovery. Thay v\xec duplicate proto files \u1edf nhi\u1ec1u n\u01a1i, b\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng shared library n\xe0y."]})}),"\n",(0,s.jsx)(t.h3,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Shared Proto Files"}),": Centralized proto files cho t\u1ea5t c\u1ea3 services"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Dynamic Discovery"}),": T\u1ef1 \u0111\u1ed9ng discover proto files trong services directory"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Path Management"}),": Utility functions \u0111\u1ec3 get proto paths"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Backward Compatibility"}),": Support legacy exports"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Customizable"}),": C\xf3 th\u1ec3 extend v\xe0 customize cho project ri\xeang"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"file-structure",children:"File Structure"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"libs/grpc/\n\u251c\u2500\u2500 proto/\n\u2502   \u251c\u2500\u2500 services/\n\u2502   \u2502   \u251c\u2500\u2500 auth.proto\n\u2502   \u2502   \u2514\u2500\u2500 user.proto\n\u2502   \u2514\u2500\u2500 README.md\n\u2514\u2500\u2500 src/\n    \u2514\u2500\u2500 proto.utils.ts\n"})}),"\n",(0,s.jsx)(t.h3,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsx)(t.h4,{id:"functions",children:"Functions"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Function"}),(0,s.jsx)(t.th,{children:"Return Type"}),(0,s.jsx)(t.th,{children:"M\xf4 t\u1ea3"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"getProtoFiles()"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string[]"})}),(0,s.jsx)(t.td,{children:"Get t\u1ea5t c\u1ea3 proto file paths trong services directory"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"getProtoPath(serviceName)"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Get proto file path theo service name"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"getProtoDir()"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Get proto root directory path"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"getServicesDir()"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Get services directory path"})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"constants",children:"Constants"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Constant"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"M\xf4 t\u1ea3"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"PROTO_PATHS"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"object"})}),(0,s.jsx)(t.td,{children:"Organized proto paths by functionality"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"PROTO_DIR"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Legacy: proto root directory (deprecated)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"SERVICES_DIR"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Legacy: services directory (deprecated)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"AUTH_PROTO"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Legacy: auth.proto path (deprecated)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"USER_PROTO"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{children:"Legacy: user.proto path (deprecated)"})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsxs)(i.A,{children:[(0,s.jsx)(a.A,{value:"basic",label:"Basic Usage",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// Import proto utils\nimport { getProtoFiles, getProtoPath, getProtoDir, PROTO_PATHS } from '@ecom-co/grpc/proto.utils';\n\n// Get all proto files\nconst allProtoFiles = getProtoFiles();\nconsole.log(allProtoFiles);\n// ['/path/to/proto/services/auth.proto', '/path/to/proto/services/user.proto']\n\n// Get specific proto file path\nconst userProtoPath = getProtoPath('user');\nconsole.log(userProtoPath);\n// '/path/to/proto/services/user.proto'\n\n// Get directories\nconst protoDir = getProtoDir();\nconst servicesDir = getServicesDir();\n\n// Using organized constants\nconsole.log(PROTO_PATHS.SERVICES.AUTH);\n// '/path/to/proto/services/auth.proto'\n"})})}),(0,s.jsx)(a.A,{value:"nestjs",label:"NestJS Integration",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// app.module.ts\nimport { Module } from '@nestjs/common';\nimport { ClientsModule, Transport } from '@nestjs/microservices';\nimport { getProtoPath, PROTO_PATHS } from '@ecom-co/grpc/proto.utils';\n\n@Module({\n    imports: [\n        ClientsModule.register([\n            {\n                name: 'AUTH_SERVICE',\n                transport: Transport.GRPC,\n                options: {\n                    package: 'auth',\n                    protoPath: getProtoPath('auth'), // Dynamic path\n                    url: 'localhost:50051',\n                },\n            },\n            {\n                name: 'USER_SERVICE',\n                transport: Transport.GRPC,\n                options: {\n                    package: 'user',\n                    protoPath: PROTO_PATHS.SERVICES.USER, // Static constant\n                    url: 'localhost:50052',\n                },\n            },\n        ]),\n    ],\n})\nexport class AppModule {}\n"})})}),(0,s.jsx)(a.A,{value:"microservice",label:"Microservice Setup",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// main.ts - gRPC Microservice\nimport { NestFactory } from '@nestjs/core';\nimport { MicroserviceOptions, Transport } from '@nestjs/microservices';\nimport { getProtoFiles, getProtoPath } from '@ecom-co/grpc/proto.utils';\nimport { AppModule } from './app.module';\n\nasync function bootstrap() {\n    // Single service\n    const app = await NestFactory.createMicroservice<MicroserviceOptions>(AppModule, {\n        transport: Transport.GRPC,\n        options: {\n            package: 'user',\n            protoPath: getProtoPath('user'),\n            url: '0.0.0.0:50052',\n        },\n    });\n\n    await app.listen();\n}\n\n// Multiple services\nasync function bootstrapMultipleServices() {\n    const allProtoFiles = getProtoFiles();\n\n    const app = await NestFactory.createMicroservice<MicroserviceOptions>(AppModule, {\n        transport: Transport.GRPC,\n        options: {\n            package: ['auth', 'user'], // Multiple packages\n            protoPath: allProtoFiles, // All proto files\n            url: '0.0.0.0:50050',\n        },\n    });\n\n    await app.listen();\n}\n\nbootstrap();\n"})})})]}),"\n",(0,s.jsx)(t.h3,{id:"customization-guide",children:"Customization Guide"}),"\n",(0,s.jsx)(t.h4,{id:"1-clone-v\xe0-setup",children:"1. Clone v\xe0 Setup"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Clone library v\u1ec1 project\ngit clone <grpc-lib-repo>\ncd libs/grpc\n\n# Install dependencies\nnpm install\n\n# Build library\nnpm run build\n"})}),"\n",(0,s.jsx)(t.h4,{id:"2-th\xeam-proto-files-m\u1edbi",children:"2. Th\xeam Proto Files M\u1edbi"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Th\xeam proto file m\u1edbi\ntouch proto/services/payment.proto\ntouch proto/services/notification.proto\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-protobuf",children:'// proto/services/payment.proto\nsyntax = "proto3";\n\npackage payment;\n\nservice PaymentService {\n    rpc ProcessPayment(PaymentRequest) returns (PaymentResponse);\n    rpc GetPaymentHistory(HistoryRequest) returns (HistoryResponse);\n}\n\nmessage PaymentRequest {\n    string user_id = 1;\n    double amount = 2;\n    string currency = 3;\n    string method = 4;\n}\n\nmessage PaymentResponse {\n    string transaction_id = 1;\n    string status = 2;\n    string message = 3;\n}\n'})}),"\n",(0,s.jsx)(t.h4,{id:"3-update-constants",children:"3. Update Constants"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// src/proto.utils.ts - Th\xeam constants m\u1edbi\nexport const PROTO_PATHS = {\n    ROOT: PROTO_ROOT,\n    SERVICES: {\n        AUTH: path.join(PROTO_ROOT, 'services', 'auth.proto'),\n        DIR: path.join(PROTO_ROOT, 'services'),\n        USER: path.join(PROTO_ROOT, 'services', 'user.proto'),\n        // Th\xeam services m\u1edbi\n        PAYMENT: path.join(PROTO_ROOT, 'services', 'payment.proto'),\n        NOTIFICATION: path.join(PROTO_ROOT, 'services', 'notification.proto'),\n    },\n} as const;\n\n// Legacy exports - th\xeam n\u1ebfu c\u1ea7n backward compatibility\nexport const PAYMENT_PROTO = PROTO_PATHS.SERVICES.PAYMENT;\nexport const NOTIFICATION_PROTO = PROTO_PATHS.SERVICES.NOTIFICATION;\n"})}),"\n",(0,s.jsx)(t.h4,{id:"4-build-v\xe0-publish",children:"4. Build v\xe0 Publish"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Build l\u1ea1i library\nnpm run build\n\n# Test functions\nnpm test\n\n# Publish (n\u1ebfu l\xe0 npm package)\nnpm publish\n"})}),"\n",(0,s.jsx)(t.h3,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,s.jsxs)(i.A,{children:[(0,s.jsx)(a.A,{value:"dynamic",label:"Dynamic Service Discovery",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// services/dynamic-grpc.service.ts\nimport { Injectable } from '@nestjs/common';\nimport { getProtoFiles } from '@ecom-co/grpc/proto.utils';\nimport * as path from 'path';\n\n@Injectable()\nexport class DynamicGrpcService {\n    private availableServices: string[] = [];\n\n    constructor() {\n        this.discoverServices();\n    }\n\n    private discoverServices() {\n        const protoFiles = getProtoFiles();\n\n        this.availableServices = protoFiles.map((filePath) => {\n            const fileName = path.basename(filePath, '.proto');\n            return fileName;\n        });\n\n        console.log('Discovered services:', this.availableServices);\n    }\n\n    getAvailableServices(): string[] {\n        return this.availableServices;\n    }\n\n    isServiceAvailable(serviceName: string): boolean {\n        return this.availableServices.includes(serviceName);\n    }\n}\n"})})}),(0,s.jsx)(a.A,{value:"config",label:"Configuration Service",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// config/grpc-config.service.ts\nimport { Injectable } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\nimport { getProtoPath, PROTO_PATHS } from '@ecom-co/grpc/proto.utils';\n\ninterface GrpcServiceConfig {\n    name: string;\n    package: string;\n    protoPath: string;\n    url: string;\n}\n\n@Injectable()\nexport class GrpcConfigService {\n    constructor(private configService: ConfigService) {}\n\n    getServiceConfig(serviceName: string): GrpcServiceConfig {\n        const baseUrl = this.configService.get('GRPC_BASE_URL', 'localhost');\n        const port = this.configService.get(`GRPC_${serviceName.toUpperCase()}_PORT`);\n\n        return {\n            name: `${serviceName.toUpperCase()}_SERVICE`,\n            package: serviceName.toLowerCase(),\n            protoPath: getProtoPath(serviceName),\n            url: `${baseUrl}:${port}`,\n        };\n    }\n\n    getAllServicesConfig(): GrpcServiceConfig[] {\n        const services = ['auth', 'user', 'payment'];\n        return services.map((service) => this.getServiceConfig(service));\n    }\n\n    // Static config cho performance\n    getStaticConfig() {\n        return {\n            AUTH_SERVICE: {\n                name: 'AUTH_SERVICE',\n                package: 'auth',\n                protoPath: PROTO_PATHS.SERVICES.AUTH,\n                url: this.configService.get('AUTH_GRPC_URL', 'localhost:50051'),\n            },\n            USER_SERVICE: {\n                name: 'USER_SERVICE',\n                package: 'user',\n                protoPath: PROTO_PATHS.SERVICES.USER,\n                url: this.configService.get('USER_GRPC_URL', 'localhost:50052'),\n            },\n        };\n    }\n}\n"})})}),(0,s.jsx)(a.A,{value:"validation",label:"Proto File Validation",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// utils/proto-validator.ts\nimport * as fs from 'fs';\nimport { getProtoFiles, getProtoPath } from '@ecom-co/grpc/proto.utils';\n\nexport class ProtoValidator {\n    static validateProtoExists(serviceName: string): boolean {\n        const protoPath = getProtoPath(serviceName);\n        return fs.existsSync(protoPath);\n    }\n\n    static validateAllProtos(): { valid: string[]; invalid: string[] } {\n        const protoFiles = getProtoFiles();\n        const valid: string[] = [];\n        const invalid: string[] = [];\n\n        protoFiles.forEach((filePath) => {\n            if (fs.existsSync(filePath)) {\n                valid.push(filePath);\n            } else {\n                invalid.push(filePath);\n            }\n        });\n\n        return { valid, invalid };\n    }\n\n    static getProtoStats() {\n        const protoFiles = getProtoFiles();\n        const stats = protoFiles.map((filePath) => ({\n            file: filePath,\n            exists: fs.existsSync(filePath),\n            size: fs.existsSync(filePath) ? fs.statSync(filePath).size : 0,\n            modified: fs.existsSync(filePath) ? fs.statSync(filePath).mtime : null,\n        }));\n\n        return {\n            total: stats.length,\n            valid: stats.filter((s) => s.exists).length,\n            invalid: stats.filter((s) => !s.exists).length,\n            details: stats,\n        };\n    }\n}\n\n// Usage\nconst validation = ProtoValidator.validateAllProtos();\nconsole.log('Proto validation:', validation);\n\nconst stats = ProtoValidator.getProtoStats();\nconsole.log('Proto stats:', stats);\n"})})})]}),"\n",(0,s.jsx)(t.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"S\u1eed d\u1ee5ng functions thay v\xec constants"})," cho dynamic paths"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Validate proto files exist"})," tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Cache proto paths"})," n\u1ebfu c\u1ea7n performance"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Version control proto files"})," c\xf9ng v\u1edbi library"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Document proto file changes"})," trong changelog"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Test proto file compatibility"})," khi update"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,s.jsx)(t.h4,{id:"t\u1eeb-legacy-constants",children:"T\u1eeb Legacy Constants"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// \u274c Old way (deprecated)\nimport { AUTH_PROTO, USER_PROTO } from '@ecom-co/grpc/proto.utils';\n\n// \u2705 New way (recommended)\nimport { PROTO_PATHS, getProtoPath } from '@ecom-co/grpc/proto.utils';\n\n// Static paths\nconst authProto = PROTO_PATHS.SERVICES.AUTH;\nconst userProto = PROTO_PATHS.SERVICES.USER;\n\n// Dynamic paths\nconst authProto = getProtoPath('auth');\nconst userProto = getProtoPath('user');\n"})}),"\n",(0,s.jsx)(t.h4,{id:"custom-proto-directory",children:"Custom Proto Directory"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// N\u1ebfu c\u1ea7n custom proto directory\nconst customProtoRoot = path.resolve(__dirname, 'custom-proto');\n\nexport const CUSTOM_PROTO_PATHS = {\n    ROOT: customProtoRoot,\n    SERVICES: {\n        CUSTOM: path.join(customProtoRoot, 'services', 'custom.proto'),\n    },\n};\n"})}),"\n",(0,s.jsx)(t.admonition,{type:"tip",children:(0,s.jsx)(t.p,{children:"Proto Utils \u0111\u01b0\u1ee3c design \u0111\u1ec3 d\u1ec5 d\xe0ng extend v\xe0 customize. B\u1ea1n c\xf3 th\u1ec3 clone library v\u1ec1, th\xeam proto files m\u1edbi, update constants v\xe0 build l\u1ea1i \u0111\u1ec3 ph\xf9 h\u1ee3p v\u1edbi project c\u1ee7a m\xecnh."})}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsx)(t.p,{children:"Khi update proto files, \u0111\u1ea3m b\u1ea3o backward compatibility \u0111\u1ec3 kh\xf4ng break existing services. S\u1eed d\u1ee5ng proto versioning n\u1ebfu c\u1ea7n breaking changes."})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var r=n(34164);const s={tabItem:"tabItem_Ymn6"};var o=n(74848);function i({children:e,hidden:t,className:n}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,n),hidden:t,children:e})}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(96540);const s={},o=r.createContext(s);function i(e){const t=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);