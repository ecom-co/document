"use strict";(self.webpackChunktemplate_docs=self.webpackChunktemplate_docs||[]).push([[7548],{11470:(e,n,t)=>{t.d(n,{A:()=>R});var i=t(96540),s=t(34164),r=t(23104),o=t(56347),d=t(205),c=t(57485),l=t(31682),a=t(70679);function h(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:i}})=>({value:e,label:n,attributes:t,default:i}))}(t);return function(e){const n=(0,l.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function u({value:e,tabValues:n}){return n.some(n=>n.value===e)}function y({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(s),(0,i.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function x(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=p(e),[o,c]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!u({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r})),[l,h]=y({queryString:t,groupId:s}),[x,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,a.Dv)(n);return[t,(0,i.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),g=(()=>{const e=l??x;return u({value:e,tabValues:r})?e:null})();(0,d.A)(()=>{g&&c(g)},[g]);return{selectedValue:o,selectValue:(0,i.useCallback)(e=>{if(!u({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),h(e),m(e)},[h,m,r]),tabValues:r}}var m=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(74848);function v({className:e,block:n,selectedValue:t,selectValue:i,tabValues:o}){const d=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),l=e=>{const n=e.currentTarget,s=d.indexOf(n),r=o[s].value;r!==t&&(c(n),i(r))},a=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=d.indexOf(e.currentTarget)+1;n=d[t]??d[0];break}case"ArrowLeft":{const t=d.indexOf(e.currentTarget)-1;n=d[t]??d[d.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:o.map(({value:e,label:n,attributes:i})=>(0,j.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{d.push(e)},onKeyDown:a,onClick:l,...i,className:(0,s.A)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function f({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===t);return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function b(e){const n=x(e);return(0,j.jsxs)("div",{className:(0,s.A)("tabs-container",g.tabList),children:[(0,j.jsx)(v,{...n,...e}),(0,j.jsx)(f,{...n,...e})]})}function R(e){const n=(0,m.A)();return(0,j.jsx)(b,{...e,children:h(e.children)},String(n))}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var i=t(96540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},99815:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"ecom-co/libs/typeorm/docs/repository","title":"Repository \u2014 Extended Repository v\xe0 Base Repository","description":"Repository module cung c\u1ea5p BaseRepository v\u1edbi c\xe1c method ti\u1ec7n \xedch nh\u01b0 findOneAndUpdate, findOneOrCreate v\xe0 c\xe1ch t\u1ea1o custom repository providers.","source":"@site/docs/ecom-co/libs/typeorm/docs/repository.md","sourceDirName":"ecom-co/libs/typeorm/docs","slug":"/repository","permalink":"/document/docs/repository","draft":false,"unlisted":false,"editUrl":"https://github.com/ecom-co/document/tree/main/docs/ecom-co/libs/typeorm/docs/repository.md","tags":[{"inline":true,"label":"repository","permalink":"/document/docs/tags/repository"},{"inline":true,"label":"base-repository","permalink":"/document/docs/tags/base-repository"},{"inline":true,"label":"extended-methods","permalink":"/document/docs/tags/extended-methods"},{"inline":true,"label":"upsert","permalink":"/document/docs/tags/upsert"},{"inline":true,"label":"find-or-create","permalink":"/document/docs/tags/find-or-create"}],"version":"current","frontMatter":{"id":"repository","title":"Repository \u2014 Extended Repository v\xe0 Base Repository","sidebar_label":"Repository","slug":"/repository","description":"Repository module cung c\u1ea5p BaseRepository v\u1edbi c\xe1c method ti\u1ec7n \xedch nh\u01b0 findOneAndUpdate, findOneOrCreate v\xe0 c\xe1ch t\u1ea1o custom repository providers.","tags":["repository","base-repository","extended-methods","upsert","find-or-create"]},"sidebar":"tutorialSidebar","previous":{"title":"Entities","permalink":"/document/docs/entities"},"next":{"title":"Transformers","permalink":"/document/docs/transformers"}}');var s=t(74848),r=t(28453);t(11470);const o={id:"repository",title:"Repository \u2014 Extended Repository v\xe0 Base Repository",sidebar_label:"Repository",slug:"/repository",description:"Repository module cung c\u1ea5p BaseRepository v\u1edbi c\xe1c method ti\u1ec7n \xedch nh\u01b0 findOneAndUpdate, findOneOrCreate v\xe0 c\xe1ch t\u1ea1o custom repository providers.",tags:["repository","base-repository","extended-methods","upsert","find-or-create"]},d=void 0,c={},l=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:2},{value:"BaseRepository",id:"baserepository",level:2},{value:"Inheritance",id:"inheritance",level:3},{value:"T\xednh n\u0103ng ch\xednh",id:"t\xednh-n\u0103ng-ch\xednh",level:3},{value:"H\u01b0\u1edbng d\u1eabn th\xeam Method m\u1edbi v\xe0o BaseRepository",id:"h\u01b0\u1edbng-d\u1eabn-th\xeam-method-m\u1edbi-v\xe0o-baserepository",level:2},{value:"1. C\u1ea5u tr\xfac BaseRepository",id:"1-c\u1ea5u-tr\xfac-baserepository",level:3},{value:"2. Th\xeam Method m\u1edbi",id:"2-th\xeam-method-m\u1edbi",level:3},{value:"Demo: Th\xeam method <code>findByStatus</code>",id:"demo-th\xeam-method-findbystatus",level:4},{value:"Demo: Th\xeam method <code>findWithPagination</code>",id:"demo-th\xeam-method-findwithpagination",level:4},{value:"C\xe1c lo\u1ea1i Method th\u01b0\u1eddng g\u1eb7p",id:"c\xe1c-lo\u1ea1i-method-th\u01b0\u1eddng-g\u1eb7p",level:4},{value:"3. Method v\u1edbi Generic Types",id:"3-method-v\u1edbi-generic-types",level:3},{value:"L\xfd thuy\u1ebft v\u1ec1 Generic Methods",id:"l\xfd-thuy\u1ebft-v\u1ec1-generic-methods",level:4},{value:"4. Method v\u1edbi Relationships",id:"4-method-v\u1edbi-relationships",level:3},{value:"L\xfd thuy\u1ebft v\u1ec1 Relationship Methods",id:"l\xfd-thuy\u1ebft-v\u1ec1-relationship-methods",level:4},{value:"5. Method v\u1edbi Transactions",id:"5-method-v\u1edbi-transactions",level:3},{value:"L\xfd thuy\u1ebft v\u1ec1 Transaction Methods",id:"l\xfd-thuy\u1ebft-v\u1ec1-transaction-methods",level:4},{value:"6. Build v\xe0 Test",id:"6-build-v\xe0-test",level:3},{value:"7. S\u1eed d\u1ee5ng Method m\u1edbi",id:"7-s\u1eed-d\u1ee5ng-method-m\u1edbi",level:3},{value:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng c\u1ee7a BaseRepository",id:"c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-baserepository",level:2},{value:"createBaseRepositoryProviders",id:"createbaserepositoryproviders",level:3},{value:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng",id:"c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng",level:3},{value:"S\u1eed d\u1ee5ng BaseRepository trong NestJS",id:"s\u1eed-d\u1ee5ng-baserepository-trong-nestjs",level:2},{value:"1. C\xe1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t - S\u1eed d\u1ee5ng OrmModule.forFeatureExtended",id:"1-c\xe1ch-\u0111\u01a1n-gi\u1ea3n-nh\u1ea5t---s\u1eed-d\u1ee5ng-ormmoduleforfeatureextended",level:3},{value:"2. Inject v\xe0 s\u1eed d\u1ee5ng BaseRepository",id:"2-inject-v\xe0-s\u1eed-d\u1ee5ng-baserepository",level:3},{value:"3. T\u1ea1o providers th\u1ee7 c\xf4ng (n\u1ebfu c\u1ea7n)",id:"3-t\u1ea1o-providers-th\u1ee7-c\xf4ng-n\u1ebfu-c\u1ea7n",level:3},{value:"S\u1eed d\u1ee5ng BaseRepository trong th\u1ef1c t\u1ebf",id:"s\u1eed-d\u1ee5ng-baserepository-trong-th\u1ef1c-t\u1ebf",level:2},{value:"1. C\xe1c lo\u1ea1i Service th\u01b0\u1eddng g\u1eb7p",id:"1-c\xe1c-lo\u1ea1i-service-th\u01b0\u1eddng-g\u1eb7p",level:3},{value:"2. Best Practices khi s\u1eed d\u1ee5ng",id:"2-best-practices-khi-s\u1eed-d\u1ee5ng",level:3},{value:"Best Practices khi s\u1eed d\u1ee5ng BaseRepository",id:"best-practices-khi-s\u1eed-d\u1ee5ng-baserepository",level:2},{value:"Migration t\u1eeb Repository c\u0169",id:"migration-t\u1eeb-repository-c\u0169",level:2},{value:"1. Thay th\u1ebf Repository type",id:"1-thay-th\u1ebf-repository-type",level:3},{value:"2. Thay th\u1ebf logic ph\u1ee9c t\u1ea1p",id:"2-thay-th\u1ebf-logic-ph\u1ee9c-t\u1ea1p",level:3},{value:"3. Thay th\u1ebf bulk operations",id:"3-thay-th\u1ebf-bulk-operations",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"L\u1ed7i th\u01b0\u1eddng g\u1eb7p",id:"l\u1ed7i-th\u01b0\u1eddng-g\u1eb7p",level:3},{value:"4. L\u1ed7i TypeScript compilation",id:"4-l\u1ed7i-typescript-compilation",level:3},{value:"T\xf3m t\u1eaft",id:"t\xf3m-t\u1eaft",level:2}];function a(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Repository module cung c\u1ea5p BaseRepository m\u1edf r\u1ed9ng t\u1eeb TypeORM Repository v\u1edbi c\xe1c method ti\u1ec7n \xedch nh\u01b0 findOneAndUpdate v\u1edbi upsert option v\xe0 findOneOrCreate v\u1edbi default values."})}),"\n",(0,s.jsx)(n.h2,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,s.jsx)(n.p,{children:"Repository module bao g\u1ed3m:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"BaseRepository"})," - Extended repository v\u1edbi c\xe1c method ti\u1ec7n \xedch"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"createBaseRepositoryProviders"})," - Function t\u1ea1o custom repository providers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enhanced methods"})," - findOneAndUpdate, findOneOrCreate"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TypeORM compatibility"})," - T\u01b0\u01a1ng th\xedch ho\xe0n to\xe0n v\u1edbi TypeORM Repository"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"baserepository",children:"BaseRepository"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"BaseRepository<Entity>"})," extends ",(0,s.jsx)(n.code,{children:"Repository<Entity>"})," v\xe0 cung c\u1ea5p c\xe1c method b\u1ed5 sung:"]}),"\n",(0,s.jsx)(n.h3,{id:"inheritance",children:"Inheritance"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export class BaseRepository<Entity extends ObjectLiteral> extends Repository<Entity>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"t\xednh-n\u0103ng-ch\xednh",children:"T\xednh n\u0103ng ch\xednh"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"T\xednh n\u0103ng"}),(0,s.jsx)(n.th,{children:"M\xf4 t\u1ea3"}),(0,s.jsx)(n.th,{children:"L\u1ee3i \xedch"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"findOneAndUpdate"})}),(0,s.jsx)(n.td,{children:"T\xecm v\xe0 update entity, h\u1ed7 tr\u1ee3 upsert"}),(0,s.jsx)(n.td,{children:"Gi\u1ea3m code boilerplate"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"findOneOrCreate"})}),(0,s.jsx)(n.td,{children:"T\xecm entity ho\u1eb7c t\u1ea1o m\u1edbi v\u1edbi defaults"}),(0,s.jsx)(n.td,{children:"X\u1eed l\xfd logic ph\u1ee9c t\u1ea1p"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"TypeORM compatibility"})}),(0,s.jsx)(n.td,{children:"T\u1ea5t c\u1ea3 methods t\u1eeb Repository"}),(0,s.jsx)(n.td,{children:"Kh\xf4ng c\u1ea7n thay \u0111\u1ed5i code c\u0169"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"h\u01b0\u1edbng-d\u1eabn-th\xeam-method-m\u1edbi-v\xe0o-baserepository",children:"H\u01b0\u1edbng d\u1eabn th\xeam Method m\u1edbi v\xe0o BaseRepository"}),"\n",(0,s.jsx)(n.h3,{id:"1-c\u1ea5u-tr\xfac-baserepository",children:"1. C\u1ea5u tr\xfac BaseRepository"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"BaseRepository"})," l\xe0 class m\u1edf r\u1ed9ng t\u1eeb TypeORM ",(0,s.jsx)(n.code,{children:"Repository"})," v\u1edbi c\xe1c method ti\u1ec7n \xedch:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export class BaseRepository<Entity extends ObjectLiteral> extends Repository<Entity> {\n  // C\xe1c method c\xf3 s\u1eb5n\n  async findOneAndUpdate(...): Promise<Entity | null>\n  async findOneOrCreate(...): Promise<Entity>\n\n  // Th\xeam method m\u1edbi \u1edf \u0111\xe2y\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-th\xeam-method-m\u1edbi",children:"2. Th\xeam Method m\u1edbi"}),"\n",(0,s.jsxs)(n.h4,{id:"demo-th\xeam-method-findbystatus",children:["Demo: Th\xeam method ",(0,s.jsx)(n.code,{children:"findByStatus"})]}),"\n",(0,s.jsx)(n.p,{children:"\u0110\xe2y l\xe0 v\xed d\u1ee5 c\u1ee5 th\u1ec3 \u0111\u1ec3 th\xeam method m\u1edbi v\xe0o BaseRepository:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/repository/extend-repository.ts\nexport class BaseRepository<Entity extends ObjectLiteral> extends Repository<Entity> {\n    // ... existing methods ...\n\n    /**\n     * T\xecm t\u1ea5t c\u1ea3 entities theo status\n     * @param status - Status \u0111\u1ec3 filter\n     * @returns Promise<Entity[]> - M\u1ea3ng entities\n     */\n    async findByStatus(status: boolean): Promise<Entity[]> {\n        return this.find({\n            where: { isActive: status } as FindOptionsWhere<Entity>,\n        });\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"demo-th\xeam-method-findwithpagination",children:["Demo: Th\xeam method ",(0,s.jsx)(n.code,{children:"findWithPagination"})]}),"\n",(0,s.jsx)(n.p,{children:"Method ph\u1ee9c t\u1ea1p h\u01a1n v\u1edbi pagination v\xe0 metadata:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export class BaseRepository<Entity extends ObjectLiteral> extends Repository<Entity> {\n    /**\n     * T\xecm entities theo custom criteria v\u1edbi pagination\n     * @param criteria - Custom criteria\n     * @param page - Trang hi\u1ec7n t\u1ea1i\n     * @param limit - S\u1ed1 l\u01b0\u1ee3ng items m\u1ed7i trang\n     * @returns Promise<{ data: Entity[], total: number, page: number, limit: number }>\n     */\n    async findWithPagination(\n        criteria: FindOptionsWhere<Entity>,\n        page: number = 1,\n        limit: number = 10,\n    ): Promise<{\n        data: Entity[];\n        total: number;\n        page: number;\n        limit: number;\n    }> {\n        const [data, total] = await this.findAndCount({\n            where: criteria,\n            skip: (page - 1) * limit,\n            take: limit,\n            order: { createdAt: 'DESC' } as FindOptionsOrder<Entity>,\n        });\n\n        return { data, total, page, limit };\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"c\xe1c-lo\u1ea1i-method-th\u01b0\u1eddng-g\u1eb7p",children:"C\xe1c lo\u1ea1i Method th\u01b0\u1eddng g\u1eb7p"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Filter Methods"}),": T\xecm entities theo criteria c\u1ee5 th\u1ec3"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByStatus()"}),": Filter theo boolean field"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByDateRange()"}),": Filter theo range date"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByField()"}),": Filter theo field b\u1ea5t k\u1ef3"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Bulk Operations"}),": X\u1eed l\xfd nhi\u1ec1u entities c\xf9ng l\xfac"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bulkUpdate()"}),": Update nhi\u1ec1u entities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bulkSoftDelete()"}),": Soft delete nhi\u1ec1u entities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bulkRestore()"}),": Restore nhi\u1ec1u entities"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Utility Methods"}),": C\xe1c method ti\u1ec7n \xedch"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findWithPagination()"}),": Pagination v\u1edbi metadata"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"searchByText()"}),": Text search tr\xean nhi\u1ec1u fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByIdWithRelations()"}),": Load entity v\u1edbi relationships"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-method-v\u1edbi-generic-types",children:"3. Method v\u1edbi Generic Types"}),"\n",(0,s.jsx)(n.h4,{id:"l\xfd-thuy\u1ebft-v\u1ec1-generic-methods",children:"L\xfd thuy\u1ebft v\u1ec1 Generic Methods"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pagination Method"}),": X\u1eed l\xfd ph\xe2n trang v\u1edbi metadata"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"FindOptionsWhere<Entity>"})," \u0111\u1ec3 type-safe criteria"]}),"\n",(0,s.jsx)(n.li,{children:"Return object ch\u1ee9a data, total, page, limit"}),"\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"findAndCount()"})," \u0111\u1ec3 l\u1ea5y c\u1ea3 data v\xe0 t\u1ed5ng s\u1ed1"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Search Method"}),": Text search tr\xean nhi\u1ec1u fields"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"keyof Entity"})," \u0111\u1ec3 type-safe field names"]}),"\n",(0,s.jsxs)(n.li,{children:["T\u1ea1o dynamic where conditions v\u1edbi ",(0,s.jsx)(n.code,{children:"Like"})," operator"]}),"\n",(0,s.jsx)(n.li,{children:"H\u1ed7 tr\u1ee3 search tr\xean nhi\u1ec1u fields c\xf9ng l\xfac"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type Safety"}),": \u0110\u1ea3m b\u1ea3o type safety v\u1edbi generic Entity"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"FindOptionsWhere<Entity>"}),": Type-safe where conditions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"FindOptionsOrder<Entity>"}),": Type-safe ordering"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"QueryDeepPartialEntity<Entity>"}),": Type-safe update data"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-method-v\u1edbi-relationships",children:"4. Method v\u1edbi Relationships"}),"\n",(0,s.jsx)(n.h4,{id:"l\xfd-thuy\u1ebft-v\u1ec1-relationship-methods",children:"L\xfd thuy\u1ebft v\u1ec1 Relationship Methods"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"findByIdWithRelations"}),": Load entity v\u1edbi relationships c\u1ee5 th\u1ec3"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"relations"})," array \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh relationships c\u1ea7n load"]}),"\n",(0,s.jsx)(n.li,{children:"Tr\xe1nh N+1 query problem b\u1eb1ng c\xe1ch load relationships c\xf9ng l\xfac"}),"\n",(0,s.jsx)(n.li,{children:"H\u1ed7 tr\u1ee3 eager loading cho performance optimization"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"findAllWithRelations"}),": Load t\u1ea5t c\u1ea3 entities v\u1edbi relationships"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"relations"})," \u0111\u1ec3 load relationships cho collection"]}),"\n",(0,s.jsx)(n.li,{children:"K\u1ebft h\u1ee3p v\u1edbi ordering \u0111\u1ec3 s\u1eafp x\u1ebfp k\u1ebft qu\u1ea3"}),"\n",(0,s.jsx)(n.li,{children:"H\u1eefu \xedch cho c\xe1c tr\u01b0\u1eddng h\u1ee3p c\u1ea7n hi\u1ec3n th\u1ecb data v\u1edbi related entities"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Performance Considerations"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ch\u1ec9 load relationships c\u1ea7n thi\u1ebft"}),"\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"select"})," \u0111\u1ec3 limit fields \u0111\u01b0\u1ee3c load"]}),"\n",(0,s.jsx)(n.li,{children:"C\xe2n nh\u1eafc gi\u1eefa eager loading v\xe0 lazy loading"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5-method-v\u1edbi-transactions",children:"5. Method v\u1edbi Transactions"}),"\n",(0,s.jsx)(n.h4,{id:"l\xfd-thuy\u1ebft-v\u1ec1-transaction-methods",children:"L\xfd thuy\u1ebft v\u1ec1 Transaction Methods"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"createWithTransaction"}),": T\u1ea1o entity trong transaction context"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"queryRunner.manager"})," thay v\xec repository methods"]}),"\n",(0,s.jsx)(n.li,{children:"\u0110\u1ea3m b\u1ea3o operation \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong transaction scope"}),"\n",(0,s.jsx)(n.li,{children:"H\u1ed7 tr\u1ee3 rollback n\u1ebfu c\xf3 l\u1ed7i x\u1ea3y ra"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"updateWithTransaction"}),": Update entity trong transaction context"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"queryRunner.manager.update()"})," \u0111\u1ec3 update"]}),"\n",(0,s.jsx)(n.li,{children:"Sau \u0111\xf3 fetch l\u1ea1i entity \u0111\u1ec3 return data m\u1edbi nh\u1ea5t"}),"\n",(0,s.jsx)(n.li,{children:"\u0110\u1ea3m b\u1ea3o consistency trong transaction"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Transaction Benefits"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Atomicity"}),": T\u1ea5t c\u1ea3 operations th\xe0nh c\xf4ng ho\u1eb7c fail c\xf9ng l\xfac"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Consistency"}),": Database state lu\xf4n consistent"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Isolation"}),": Transactions kh\xf4ng \u1ea3nh h\u01b0\u1edfng l\u1eabn nhau"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Durability"}),": Changes \u0111\u01b0\u1ee3c persist sau khi commit"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"6-build-v\xe0-test",children:"6. Build v\xe0 Test"}),"\n",(0,s.jsx)(n.p,{children:"Sau khi th\xeam method m\u1edbi:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Build library\nnpm run build\n\n# Run linting\nnpm run lint\n\n# Test build\nnpm run test\n\n# Verify TypeScript compilation\nnpx tsc --noEmit\n"})}),"\n",(0,s.jsx)(n.h3,{id:"7-s\u1eed-d\u1ee5ng-method-m\u1edbi",children:"7. S\u1eed d\u1ee5ng Method m\u1edbi"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@Injectable()\nexport class UserService {\n    constructor(\n        @InjectRepository(User)\n        private userRepo: BaseRepository<User>,\n    ) {}\n\n    // S\u1eed d\u1ee5ng method m\u1edbi\n    async getActiveUsers(): Promise<User[]> {\n        return this.userRepo.findByStatus(true);\n    }\n\n    async getUsersByDateRange(start: Date, end: Date): Promise<User[]> {\n        return this.userRepo.findByDateRange(start, end);\n    }\n\n    async getUsersWithPagination(page: number, limit: number): Promise<any> {\n        return this.userRepo.findWithPagination({}, page, limit);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-baserepository",children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng c\u1ee7a BaseRepository"}),"\n",(0,s.jsx)(n.h3,{id:"createbaserepositoryproviders",children:"createBaseRepositoryProviders"}),"\n",(0,s.jsxs)(n.p,{children:["Function n\xe0y t\u1ea1o custom repository providers cho ph\xe9p inject ",(0,s.jsx)(n.code,{children:"BaseRepository<Entity>"})," thay v\xec ",(0,s.jsx)(n.code,{children:"Repository<Entity>"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export const createBaseRepositoryProviders = (entities: EntityClassOrSchema[]): Provider[] =>\n    entities.map((entity) => ({\n        inject: [DataSource],\n        provide: getRepositoryToken(entity),\n        useFactory: (dataSource: DataSource) => {\n            const repo = dataSource.getRepository(entity as EntityTarget<ObjectLiteral>);\n\n            // Mix BaseRepository methods v\xe0o standard repository\n            Object.setPrototypeOf(repo, BaseRepository.prototype);\n\n            return repo;\n        },\n    }));\n"})}),"\n",(0,s.jsx)(n.h3,{id:"c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng",children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"L\u1ea5y standard repository"})," t\u1eeb DataSource"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Mix BaseRepository methods"})," v\xe0o standard repository"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Override repository token"})," \u0111\u1ec3 inject BaseRepository"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"T\u1ef1 \u0111\u1ed9ng c\xf3 t\u1ea5t c\u1ea3 methods"})," t\u1eeb c\u1ea3 Repository v\xe0 BaseRepository"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"s\u1eed-d\u1ee5ng-baserepository-trong-nestjs",children:"S\u1eed d\u1ee5ng BaseRepository trong NestJS"}),"\n",(0,s.jsx)(n.h3,{id:"1-c\xe1ch-\u0111\u01a1n-gi\u1ea3n-nh\u1ea5t---s\u1eed-d\u1ee5ng-ormmoduleforfeatureextended",children:"1. C\xe1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t - S\u1eed d\u1ee5ng OrmModule.forFeatureExtended"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { OrmModule } from '@ecom-co/orm';\n\n@Module({\n    imports: [\n        OrmModule.forFeatureExtended([User, Product]), // T\u1ef1 \u0111\u1ed9ng t\u1ea1o BaseRepository providers\n    ],\n})\nexport class UserModule {}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-inject-v\xe0-s\u1eed-d\u1ee5ng-baserepository",children:"2. Inject v\xe0 s\u1eed d\u1ee5ng BaseRepository"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { Injectable } from '@nestjs/common';\nimport { InjectRepository } from '@nestjs/typeorm';\nimport { BaseRepository } from '@ecom-co/orm';\nimport { User } from '@ecom-co/orm';\n\n@Injectable()\nexport class UserService {\n    constructor(\n        @InjectRepository(User)\n        private userRepo: BaseRepository<User>, // S\u1eed d\u1ee5ng BaseRepository thay v\xec Repository\n    ) {}\n\n    // S\u1eed d\u1ee5ng method c\xf3 s\u1eb5n\n    async findOrCreateUser(email: string): Promise<User> {\n        return this.userRepo.findOneOrCreate({ email }, { isActive: true });\n    }\n\n    // S\u1eed d\u1ee5ng method m\u1edbi \u0111\xe3 th\xeam\n    async getActiveUsers(): Promise<User[]> {\n        return this.userRepo.findByStatus(true);\n    }\n\n    async getUsersByDateRange(start: Date, end: Date): Promise<User[]> {\n        return this.userRepo.findByDateRange(start, end);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-t\u1ea1o-providers-th\u1ee7-c\xf4ng-n\u1ebfu-c\u1ea7n",children:"3. T\u1ea1o providers th\u1ee7 c\xf4ng (n\u1ebfu c\u1ea7n)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common';\nimport { TypeOrmModule } from '@nestjs/typeorm';\nimport { createBaseRepositoryProviders } from '@ecom-co/orm';\nimport { User, Product } from '@ecom-co/orm';\n\n@Module({\n    imports: [TypeOrmModule.forFeature([User, Product])],\n    providers: [\n        ...createBaseRepositoryProviders([User, Product]), // T\u1ea1o BaseRepository providers\n    ],\n})\nexport class CustomModule {}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"s\u1eed-d\u1ee5ng-baserepository-trong-th\u1ef1c-t\u1ebf",children:"S\u1eed d\u1ee5ng BaseRepository trong th\u1ef1c t\u1ebf"}),"\n",(0,s.jsx)(n.h3,{id:"1-c\xe1c-lo\u1ea1i-service-th\u01b0\u1eddng-g\u1eb7p",children:"1. C\xe1c lo\u1ea1i Service th\u01b0\u1eddng g\u1eb7p"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Basic Service"}),": S\u1eed d\u1ee5ng methods c\xf3 s\u1eb5n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findOneOrCreate()"}),": T\xecm ho\u1eb7c t\u1ea1o entity m\u1edbi"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findOneAndUpdate()"}),": T\xecm v\xe0 update entity"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByStatus()"}),": Filter theo status"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Advanced Service"}),": S\u1eed d\u1ee5ng methods m\u1edbi \u0111\xe3 th\xeam"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findByDateRange()"}),": Filter theo range date"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"findWithPagination()"}),": Pagination v\u1edbi metadata"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"searchByText()"}),": Text search tr\xean nhi\u1ec1u fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bulkSoftDelete()"}),": Bulk operations"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Transactional Service"}),": S\u1eed d\u1ee5ng transaction methods"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"createWithTransaction()"}),": T\u1ea1o entity trong transaction"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"updateWithTransaction()"}),": Update entity trong transaction"]}),"\n",(0,s.jsx)(n.li,{children:"\u0110\u1ea3m b\u1ea3o data consistency"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-best-practices-khi-s\u1eed-d\u1ee5ng",children:"2. Best Practices khi s\u1eed d\u1ee5ng"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type Safety"}),": Lu\xf4n khai b\xe1o ",(0,s.jsx)(n.code,{children:"BaseRepository<Entity>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Method Selection"}),": Ch\u1ecdn method ph\xf9 h\u1ee3p v\u1edbi use case"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Handling"}),": X\u1eed l\xfd l\u1ed7i ph\xf9 h\u1ee3p cho t\u1eebng method"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": S\u1eed d\u1ee5ng bulk operations cho large datasets"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices-khi-s\u1eed-d\u1ee5ng-baserepository",children:"Best Practices khi s\u1eed d\u1ee5ng BaseRepository"}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"S\u1eed d\u1ee5ng OrmModule.forFeatureExtended"}),": \u0110\xe2y l\xe0 c\xe1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t \u0111\u1ec3 c\xf3 BaseRepository t\u1ef1 \u0111\u1ed9ng."]})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type Safety"}),": Lu\xf4n khai b\xe1o type ",(0,s.jsx)(n.code,{children:"BaseRepository<Entity>"})," \u0111\u1ec3 c\xf3 \u0111\u01b0\u1ee3c type safety v\xe0 IntelliSense."]})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Method Naming"}),": \u0110\u1eb7t t\xean method r\xf5 r\xe0ng, m\xf4 t\u1ea3 ch\xednh x\xe1c ch\u1ee9c n\u0103ng c\u1ee7a method."]})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Provider Override"}),": ",(0,s.jsx)(n.code,{children:"createBaseRepositoryProviders"})," override default repository tokens, ch\u1ec9 s\u1eed d\u1ee5ng khi c\u1ea7n thi\u1ebft."]})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Compatibility"}),": BaseRepository t\u01b0\u01a1ng th\xedch ho\xe0n to\xe0n v\u1edbi TypeORM Repository, c\xf3 th\u1ec3 s\u1eed d\u1ee5ng t\u1ea5t c\u1ea3 methods g\u1ed1c."]})}),"\n",(0,s.jsx)(n.h2,{id:"migration-t\u1eeb-repository-c\u0169",children:"Migration t\u1eeb Repository c\u0169"}),"\n",(0,s.jsx)(n.h3,{id:"1-thay-th\u1ebf-repository-type",children:"1. Thay th\u1ebf Repository type"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c C\u0169\n@InjectRepository(User)\nprivate userRepo: Repository<User>;\n\n// \u2705 M\u1edbi\n@InjectRepository(User)\nprivate userRepo: BaseRepository<User>;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-thay-th\u1ebf-logic-ph\u1ee9c-t\u1ea1p",children:"2. Thay th\u1ebf logic ph\u1ee9c t\u1ea1p"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c Logic c\u0169 - ph\u1ee9c t\u1ea1p\nasync findOrCreateUser(email: string): Promise<User> {\n  let user = await this.userRepo.findOne({ where: { email } });\n  if (!user) {\n    user = this.userRepo.create({ email, isActive: true });\n    await this.userRepo.save(user);\n  }\n  return user;\n}\n\n// \u2705 S\u1eed d\u1ee5ng BaseRepository - \u0111\u01a1n gi\u1ea3n\nasync findOrCreateUser(email: string): Promise<User> {\n  return this.userRepo.findOneOrCreate(\n    { email },\n    { isActive: true }\n  );\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-thay-th\u1ebf-bulk-operations",children:"3. Thay th\u1ebf bulk operations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c Logic c\u0169 - nhi\u1ec1u queries\nasync deactivateUsers(userIds: string[]): Promise<void> {\n  for (const id of userIds) {\n    await this.userRepo.update(id, { isActive: false });\n  }\n}\n\n// \u2705 S\u1eed d\u1ee5ng BaseRepository - m\u1ed9t query\nasync deactivateUsers(userIds: string[]): Promise<void> {\n  await this.userRepo.bulkUpdate(userIds, { isActive: false });\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"l\u1ed7i-th\u01b0\u1eddng-g\u1eb7p",children:"L\u1ed7i th\u01b0\u1eddng g\u1eb7p"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type Error"}),": ",(0,s.jsx)(n.code,{children:"Property 'findByStatus' does not exist on type 'Repository<User>'"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nguy\xean nh\xe2n"}),": Ch\u01b0a inject BaseRepository"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Gi\u1ea3i ph\xe1p"}),": S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"OrmModule.forFeatureExtended()"})," ho\u1eb7c ",(0,s.jsx)(n.code,{children:"createBaseRepositoryProviders()"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Method kh\xf4ng ho\u1ea1t \u0111\u1ed9ng"}),": Method m\u1edbi kh\xf4ng \u0111\u01b0\u1ee3c nh\u1eadn di\u1ec7n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nguy\xean nh\xe2n"}),": Ch\u01b0a build l\u1ea1i library"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Gi\u1ea3i ph\xe1p"}),": Ch\u1ea1y ",(0,s.jsx)(n.code,{children:"npm run build"})," sau khi th\xeam method m\u1edbi"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Circular Dependency"}),": L\u1ed7i circular dependency khi s\u1eed d\u1ee5ng BaseRepository"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nguy\xean nh\xe2n"}),": Import/export kh\xf4ng \u0111\xfang"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Gi\u1ea3i ph\xe1p"}),": Ki\u1ec3m tra l\u1ea1i c\u1ea5u tr\xfac import/export trong entities"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-l\u1ed7i-typescript-compilation",children:"4. L\u1ed7i TypeScript compilation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u274c L\u1ed7i: Type 'Repository<User>' is not assignable to type 'BaseRepository<User>'\n@InjectRepository(User)\nprivate userRepo: BaseRepository<User>;\n\n// \u2705 Gi\u1ea3i ph\xe1p: S\u1eed d\u1ee5ng OrmModule.forFeatureExtended\n@Module({\n  imports: [\n    OrmModule.forFeatureExtended([User]), // T\u1ef1 \u0111\u1ed9ng t\u1ea1o BaseRepository\n  ],\n})\nexport class UserModule {}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"t\xf3m-t\u1eaft",children:"T\xf3m t\u1eaft"}),"\n",(0,s.jsx)(n.p,{children:"BaseRepository cung c\u1ea5p c\xe1c method ti\u1ec7n \xedch m\u1edf r\u1ed9ng t\u1eeb TypeORM Repository:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findOneAndUpdate"}),": T\xecm v\xe0 update entity, h\u1ed7 tr\u1ee3 upsert"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findOneOrCreate"}),": T\xecm entity ho\u1eb7c t\u1ea1o m\u1edbi v\u1edbi defaults"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findByStatus"}),": Filter entities theo status"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findByDateRange"}),": Filter entities theo range date"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"bulkUpdate"}),": Update nhi\u1ec1u entities c\xf9ng l\xfac"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"bulkSoftDelete"}),": Soft delete nhi\u1ec1u entities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findWithPagination"}),": Pagination v\u1edbi metadata"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"searchByText"}),": Text search tr\xean nhi\u1ec1u fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findByIdWithRelations"}),": Load entity v\u1edbi relationships"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"createWithTransaction"}),": T\u1ea1o entity v\u1edbi transaction"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"updateWithTransaction"}),": Update entity v\u1edbi transaction"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u0110\u1ec3 s\u1eed d\u1ee5ng BaseRepository, ch\u1ec9 c\u1ea7n:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"OrmModule.forFeatureExtended([Entity])"})]}),"\n",(0,s.jsxs)(n.li,{children:["Inject v\u1edbi type ",(0,s.jsx)(n.code,{children:"BaseRepository<Entity>"})]}),"\n",(0,s.jsx)(n.li,{children:"S\u1eed d\u1ee5ng c\xe1c method ti\u1ec7n \xedch"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);