"use strict";(self.webpackChunktemplate_docs=self.webpackChunktemplate_docs||[]).push([[2135],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(96540);const c={},s=r.createContext(c);function t(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),r.createElement(s.Provider,{value:n},e.children)}},59754:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"tips/circular-dependency","title":"Circular Dependency","description":"Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 Circular Dependency trong NestJS - Nguy\xean nh\xe2n, c\xe1ch ph\xe1t hi\u1ec7n v\xe0 c\xe1c gi\u1ea3i ph\xe1p hi\u1ec7u qu\u1ea3","source":"@site/docs/tips/circular-dependency.md","sourceDirName":"tips","slug":"/tips/circular-dependency","permalink":"/document/vi/docs/tips/circular-dependency","draft":false,"unlisted":false,"editUrl":"https://github.com/ecom-co/document/tree/main/docs/tips/circular-dependency.md","tags":[],"version":"current","frontMatter":{"title":"Circular Dependency","description":"Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 Circular Dependency trong NestJS - Nguy\xean nh\xe2n, c\xe1ch ph\xe1t hi\u1ec7n v\xe0 c\xe1c gi\u1ea3i ph\xe1p hi\u1ec7u qu\u1ea3"},"sidebar":"tutorialSidebar","previous":{"title":"Decorators","permalink":"/document/vi/docs/overview/decorators"},"next":{"title":"Memory Leaks","permalink":"/document/vi/docs/tips/memory-leaks"}}');var c=i(74848),s=i(28453);const t={title:"Circular Dependency",description:"Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 Circular Dependency trong NestJS - Nguy\xean nh\xe2n, c\xe1ch ph\xe1t hi\u1ec7n v\xe0 c\xe1c gi\u1ea3i ph\xe1p hi\u1ec7u qu\u1ea3"},l="Circular Dependency trong NestJS",d={},a=[{value:"\ud83c\udfaf T\u1ea1i sao c\u1ea7n hi\u1ec3u v\u1ec1 Circular Dependency?",id:"-t\u1ea1i-sao-c\u1ea7n-hi\u1ec3u-v\u1ec1-circular-dependency",level:2},{value:"\ud83d\udd0d Circular Dependency l\xe0 g\xec?",id:"-circular-dependency-l\xe0-g\xec",level:2},{value:"\ud83d\udea8 T\u1ea1i sao Circular Dependency nguy hi\u1ec3m?",id:"-t\u1ea1i-sao-circular-dependency-nguy-hi\u1ec3m",level:2},{value:"\ud83d\udcca Bi\u1ec3u \u0111\u1ed3 Circular Dependency",id:"-bi\u1ec3u-\u0111\u1ed3-circular-dependency",level:2},{value:"Bi\u1ec3u \u0111\u1ed3 1: Circular Dependency gi\u1eefa Services",id:"bi\u1ec3u-\u0111\u1ed3-1-circular-dependency-gi\u1eefa-services",level:3},{value:"Nguy\xean nh\xe2n g\xe2y ra Circular Dependency",id:"nguy\xean-nh\xe2n-g\xe2y-ra-circular-dependency",level:2},{value:"1. Service Dependencies",id:"1-service-dependencies",level:3},{value:"2. Module Dependencies",id:"2-module-dependencies",level:3},{value:"C\xe1ch ph\xe1t hi\u1ec7n Circular Dependency",id:"c\xe1ch-ph\xe1t-hi\u1ec7n-circular-dependency",level:2},{value:"1. Error Messages",id:"1-error-messages",level:3},{value:"2. Debug Mode",id:"2-debug-mode",level:3},{value:"Gi\u1ea3i ph\xe1p cho Circular Dependency",id:"gi\u1ea3i-ph\xe1p-cho-circular-dependency",level:2},{value:"1. S\u1eed d\u1ee5ng Forward Reference",id:"1-s\u1eed-d\u1ee5ng-forward-reference",level:3},{value:"Bi\u1ec3u \u0111\u1ed3 2: Forward Reference Resolution",id:"bi\u1ec3u-\u0111\u1ed3-2-forward-reference-resolution",level:3},{value:"Forward Reference v\u1edbi Services",id:"forward-reference-v\u1edbi-services",level:4},{value:"Forward Reference v\u1edbi Modules",id:"forward-reference-v\u1edbi-modules",level:4},{value:"2. T\xe1i c\u1ea5u tr\xfac Architecture",id:"2-t\xe1i-c\u1ea5u-tr\xfac-architecture",level:3},{value:"S\u1eed d\u1ee5ng Event Pattern",id:"s\u1eed-d\u1ee5ng-event-pattern",level:4},{value:"Bi\u1ec3u \u0111\u1ed3 3: Event Pattern Architecture",id:"bi\u1ec3u-\u0111\u1ed3-3-event-pattern-architecture",level:3},{value:"S\u1eed d\u1ee5ng Interface Segregation",id:"s\u1eed-d\u1ee5ng-interface-segregation",level:4},{value:"Bi\u1ec3u \u0111\u1ed3 4: Interface Segregation Pattern",id:"bi\u1ec3u-\u0111\u1ed3-4-interface-segregation-pattern",level:3},{value:"3. S\u1eed d\u1ee5ng Factory Pattern",id:"3-s\u1eed-d\u1ee5ng-factory-pattern",level:3},{value:"Bi\u1ec3u \u0111\u1ed3 5: Factory Pattern",id:"bi\u1ec3u-\u0111\u1ed3-5-factory-pattern",level:3},{value:"4. S\u1eed d\u1ee5ng Shared Module",id:"4-s\u1eed-d\u1ee5ng-shared-module",level:3},{value:"Bi\u1ec3u \u0111\u1ed3 7: Shared Module Pattern",id:"bi\u1ec3u-\u0111\u1ed3-7-shared-module-pattern",level:3},{value:"5. S\u1eed d\u1ee5ng Lazy Loading",id:"5-s\u1eed-d\u1ee5ng-lazy-loading",level:3},{value:"6. \ud83d\ude80 Gi\u1ea3i ph\xe1p T\u1ed1i \u01b0u: Domain-Driven Design v\u1edbi Clean Architecture",id:"6--gi\u1ea3i-ph\xe1p-t\u1ed1i-\u01b0u-domain-driven-design-v\u1edbi-clean-architecture",level:3},{value:"Bi\u1ec3u \u0111\u1ed3 8: DDD + Clean Architecture",id:"bi\u1ec3u-\u0111\u1ed3-8-ddd--clean-architecture",level:3},{value:"\ud83d\udd27 C\xe1ch X\u1eed L\xfd Circular Dependency Step-by-Step",id:"-c\xe1ch-x\u1eed-l\xfd-circular-dependency-step-by-step",level:2},{value:"B\u01b0\u1edbc 1: Ph\xe2n t\xedch v\xe0 X\xe1c \u0111\u1ecbnh V\u1ea5n \u0111\u1ec1",id:"b\u01b0\u1edbc-1-ph\xe2n-t\xedch-v\xe0-x\xe1c-\u0111\u1ecbnh-v\u1ea5n-\u0111\u1ec1",level:3},{value:"B\u01b0\u1edbc 2: Ch\u1ecdn Gi\u1ea3i ph\xe1p Ph\xf9 h\u1ee3p",id:"b\u01b0\u1edbc-2-ch\u1ecdn-gi\u1ea3i-ph\xe1p-ph\xf9-h\u1ee3p",level:3},{value:"B\u01b0\u1edbc 3: Implement Gi\u1ea3i ph\xe1p",id:"b\u01b0\u1edbc-3-implement-gi\u1ea3i-ph\xe1p",level:3},{value:"B\u01b0\u1edbc 4: Test v\xe0 Verify",id:"b\u01b0\u1edbc-4-test-v\xe0-verify",level:3},{value:"B\u01b0\u1edbc 5: Monitor v\xe0 Maintain",id:"b\u01b0\u1edbc-5-monitor-v\xe0-maintain",level:3},{value:"\ud83d\udccb Checklist X\u1eed L\xfd Circular Dependency",id:"-checklist-x\u1eed-l\xfd-circular-dependency",level:2},{value:"\u2705 <strong>Tr\u01b0\u1edbc khi Implement:</strong>",id:"-tr\u01b0\u1edbc-khi-implement",level:3},{value:"\u2705 <strong>Trong qu\xe1 tr\xecnh Implement:</strong>",id:"-trong-qu\xe1-tr\xecnh-implement",level:3},{value:"\u2705 <strong>Sau khi Implement:</strong>",id:"-sau-khi-implement",level:3},{value:"\ud83c\udfaf <strong>K\u1ebft qu\u1ea3 mong \u0111\u1ee3i:</strong>",id:"-k\u1ebft-qu\u1ea3-mong-\u0111\u1ee3i",level:2},{value:"Bi\u1ec3u \u0111\u1ed3 6: Lazy Loading Pattern",id:"bi\u1ec3u-\u0111\u1ed3-6-lazy-loading-pattern",level:3},{value:"Best Practices \u0111\u1ec3 tr\xe1nh Circular Dependency",id:"best-practices-\u0111\u1ec3-tr\xe1nh-circular-dependency",level:2},{value:"1. Thi\u1ebft k\u1ebf Architecture",id:"1-thi\u1ebft-k\u1ebf-architecture",level:3},{value:"2. Dependency Direction",id:"2-dependency-direction",level:3},{value:"3. Single Responsibility",id:"3-single-responsibility",level:3},{value:"Testing Circular Dependency",id:"testing-circular-dependency",level:2},{value:"1. Unit Test",id:"1-unit-test",level:3},{value:"2. Integration Test",id:"2-integration-test",level:3},{value:"Monitoring v\xe0 Debugging",id:"monitoring-v\xe0-debugging",level:2},{value:"1. Dependency Graph",id:"1-dependency-graph",level:3},{value:"2. Circular Dependency Detector",id:"2-circular-dependency-detector",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"circular-dependency-trong-nestjs",children:"Circular Dependency trong NestJS"})}),"\n",(0,c.jsx)(n.p,{children:"Circular dependency (ph\u1ee5 thu\u1ed9c v\xf2ng tr\xf2n) l\xe0 m\u1ed9t v\u1ea5n \u0111\u1ec1 ph\u1ed5 bi\u1ebfn trong NestJS khi hai ho\u1eb7c nhi\u1ec1u module, service, ho\u1eb7c provider ph\u1ee5 thu\u1ed9c l\u1eabn nhau, t\u1ea1o th\xe0nh m\u1ed9t v\xf2ng l\u1eb7p v\xf4 h\u1ea1n."}),"\n",(0,c.jsx)(n.h2,{id:"-t\u1ea1i-sao-c\u1ea7n-hi\u1ec3u-v\u1ec1-circular-dependency",children:"\ud83c\udfaf T\u1ea1i sao c\u1ea7n hi\u1ec3u v\u1ec1 Circular Dependency?"}),"\n",(0,c.jsx)(n.p,{children:"Trong qu\xe1 tr\xecnh ph\xe1t tri\u1ec3n \u1ee9ng d\u1ee5ng NestJS, b\u1ea1n s\u1ebd th\u01b0\u1eddng xuy\xean g\u1eb7p ph\u1ea3i v\u1ea5n \u0111\u1ec1 circular dependency. \u0110\xe2y kh\xf4ng ch\u1ec9 l\xe0 m\u1ed9t l\u1ed7i k\u1ef9 thu\u1eadt \u0111\u01a1n gi\u1ea3n, m\xe0 c\xf2n l\xe0 d\u1ea5u hi\u1ec7u c\u1ee7a vi\u1ec7c thi\u1ebft k\u1ebf architecture ch\u01b0a t\u1ed1i \u01b0u. Hi\u1ec3u r\xf5 v\u1ec1 circular dependency s\u1ebd gi\xfap b\u1ea1n:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Tr\xe1nh \u0111\u01b0\u1ee3c c\xe1c l\u1ed7i runtime"})," g\xe2y crash \u1ee9ng d\u1ee5ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Thi\u1ebft k\u1ebf architecture t\u1ed1t h\u01a1n"})," v\u1edbi dependency flow r\xf5 r\xe0ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Vi\u1ebft code d\u1ec5 maintain"})," v\xe0 m\u1edf r\u1ed9ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"T\u0103ng performance"})," c\u1ee7a \u1ee9ng d\u1ee5ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Gi\u1ea3m th\u1eddi gian debug"})," khi g\u1eb7p v\u1ea5n \u0111\u1ec1"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"-circular-dependency-l\xe0-g\xec",children:"\ud83d\udd0d Circular Dependency l\xe0 g\xec?"}),"\n",(0,c.jsx)(n.p,{children:"Circular dependency x\u1ea3y ra khi:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service A"})," c\u1ea7n ",(0,c.jsx)(n.strong,{children:"Service B"})," \u0111\u1ec3 ho\u1ea1t \u0111\u1ed9ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service B"})," l\u1ea1i c\u1ea7n ",(0,c.jsx)(n.strong,{children:"Service A"})," \u0111\u1ec3 ho\u1ea1t \u0111\u1ed9ng"]}),"\n",(0,c.jsx)(n.li,{children:"T\u1ea1o th\xe0nh m\u1ed9t v\xf2ng l\u1eb7p v\xf4 h\u1ea1n: A \u2192 B \u2192 A \u2192 B \u2192 ..."}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u0110i\u1ec1u n\xe0y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 vi\u1ec7c:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"B\u1ea1n m\u01b0\u1ee3n ti\u1ec1n c\u1ee7a ng\u01b0\u1eddi b\u1ea1n"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Ng\u01b0\u1eddi b\u1ea1n l\u1ea1i m\u01b0\u1ee3n ti\u1ec1n c\u1ee7a b\u1ea1n"})}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea3 hai \u0111\u1ec1u kh\xf4ng th\u1ec3 tr\u1ea3 n\u1ee3 v\xec \u0111ang ch\u1edd nhau"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"-t\u1ea1i-sao-circular-dependency-nguy-hi\u1ec3m",children:"\ud83d\udea8 T\u1ea1i sao Circular Dependency nguy hi\u1ec3m?"}),"\n",(0,c.jsx)(n.p,{children:"Circular dependency g\xe2y ra nhi\u1ec1u v\u1ea5n \u0111\u1ec1 nghi\xeam tr\u1ecdng:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"L\u1ed7i Runtime:"})," \u1ee8ng d\u1ee5ng kh\xf4ng th\u1ec3 kh\u1edfi t\u1ea1o \u0111\u01b0\u1ee3c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Memory Leaks:"})," T\u1ea1o ra c\xe1c object kh\xf4ng th\u1ec3 gi\u1ea3i ph\xf3ng"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Kh\xf3 Debug:"})," Kh\xf3 x\xe1c \u0111\u1ecbnh nguy\xean nh\xe2n g\u1ed1c r\u1ec5"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Performance Issues:"})," L\xe0m ch\u1eadm qu\xe1 tr\xecnh kh\u1edfi t\u1ea1o"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Code Maintenance:"})," Kh\xf3 thay \u0111\u1ed5i v\xe0 m\u1edf r\u1ed9ng code"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"-bi\u1ec3u-\u0111\u1ed3-circular-dependency",children:"\ud83d\udcca Bi\u1ec3u \u0111\u1ed3 Circular Dependency"}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-1-circular-dependency-gi\u1eefa-services",children:"Bi\u1ec3u \u0111\u1ed3 1: Circular Dependency gi\u1eefa Services"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[Service A] --\x3e B[Service B]\n    B --\x3e C[Service C]\n    C --\x3e A\n    \n    style A fill:#ff6b6b\n    style B fill:#4ecdc4\n    style C fill:#45b7d1\n    \n    D[Module A] --\x3e E[Module B]\n    E --\x3e D\n    \n    style D fill:#96ceb4\n    style E fill:#feca57"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service A"})," ph\u1ee5 thu\u1ed9c v\xe0o ",(0,c.jsx)(n.strong,{children:"Service B"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service B"})," ph\u1ee5 thu\u1ed9c v\xe0o ",(0,c.jsx)(n.strong,{children:"Service C"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service C"})," l\u1ea1i ph\u1ee5 thu\u1ed9c v\xe0o ",(0,c.jsx)(n.strong,{children:"Service A"})]}),"\n",(0,c.jsx)(n.li,{children:"T\u1ea1o th\xe0nh v\xf2ng l\u1eb7p v\xf4 h\u1ea1n"}),"\n"]}),"\n",(0,c.jsxs)(n.admonition,{title:"\u26a0\ufe0f V\u1ea5n \u0111\u1ec1 nghi\xeam tr\u1ecdng",type:"danger",children:[(0,c.jsx)(n.p,{children:"Circular dependency c\xf3 th\u1ec3 g\xe2y ra:"}),(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"L\u1ed7i runtime crash"}),"\n",(0,c.jsx)(n.li,{children:"Memory leaks"}),"\n",(0,c.jsx)(n.li,{children:"Kh\u1edfi t\u1ea1o \u1ee9ng d\u1ee5ng th\u1ea5t b\u1ea1i"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf3 debug v\xe0 maintain"}),"\n"]})]}),"\n",(0,c.jsx)(n.h2,{id:"nguy\xean-nh\xe2n-g\xe2y-ra-circular-dependency",children:"Nguy\xean nh\xe2n g\xe2y ra Circular Dependency"}),"\n",(0,c.jsx)(n.h3,{id:"1-service-dependencies",children:"1. Service Dependencies"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="V\xed d\u1ee5 Circular Dependency gi\u1eefa Services"',children:"// user.service.ts\n@Injectable()\nexport class UserService {\n  constructor(private emailService: EmailService) {}\n  \n  async createUser(userData: CreateUserDto) {\n    // T\u1ea1o user\n    const user = await this.userRepository.save(userData);\n    \n    // G\u1eedi email th\xf4ng b\xe1o\n    await this.emailService.sendWelcomeEmail(user.email);\n    \n    return user;\n  }\n}\n\n// email.service.ts\n@Injectable()\nexport class EmailService {\n  constructor(private userService: UserService) {} // \u274c Circular!\n  \n  async sendWelcomeEmail(email: string) {\n    // L\u1ea5y th\xf4ng tin user \u0111\u1ec3 g\u1eedi email\n    const user = await this.userService.findByEmail(email);\n    // G\u1eedi email...\n  }\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"2-module-dependencies",children:"2. Module Dependencies"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="V\xed d\u1ee5 Circular Dependency gi\u1eefa Modules"',children:"// user.module.ts\n@Module({\n  imports: [EmailModule], // Import EmailModule\n  providers: [UserService],\n  exports: [UserService]\n})\nexport class UserModule {}\n\n// email.module.ts\n@Module({\n  imports: [UserModule], // \u274c Circular! Import UserModule\n  providers: [EmailService],\n  exports: [EmailService]\n})\nexport class EmailModule {}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"c\xe1ch-ph\xe1t-hi\u1ec7n-circular-dependency",children:"C\xe1ch ph\xe1t hi\u1ec7n Circular Dependency"}),"\n",(0,c.jsx)(n.h3,{id:"1-error-messages",children:"1. Error Messages"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# L\u1ed7i th\u01b0\u1eddng g\u1eb7p\nError: Nest can't resolve dependencies of the UserService (?). \nPlease make sure that the argument EmailService at index [0] is available in the UserModule context.\n\n# Ho\u1eb7c\nError: Circular dependency detected\n"})}),"\n",(0,c.jsx)(n.h3,{id:"2-debug-mode",children:"2. Debug Mode"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="B\u1eadt Debug Mode"',children:"// main.ts\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule, {\n    logger: ['error', 'warn', 'debug', 'log', 'verbose']\n  });\n  await app.listen(3000);\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"gi\u1ea3i-ph\xe1p-cho-circular-dependency",children:"Gi\u1ea3i ph\xe1p cho Circular Dependency"}),"\n",(0,c.jsx)(n.p,{children:"Khi g\u1eb7p ph\u1ea3i circular dependency, b\u1ea1n c\xf3 nhi\u1ec1u c\xe1ch \u0111\u1ec3 gi\u1ea3i quy\u1ebft. M\u1ed7i gi\u1ea3i ph\xe1p c\xf3 \u01b0u \u0111i\u1ec3m v\xe0 nh\u01b0\u1ee3c \u0111i\u1ec3m ri\xeang. H\xe3y c\xf9ng t\xecm hi\u1ec3u chi ti\u1ebft t\u1eebng ph\u01b0\u01a1ng ph\xe1p:"}),"\n",(0,c.jsx)(n.h3,{id:"1-s\u1eed-d\u1ee5ng-forward-reference",children:"1. S\u1eed d\u1ee5ng Forward Reference"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Forward Reference"})," l\xe0 c\xe1ch gi\u1ea3i quy\u1ebft nhanh nh\u1ea5t v\xe0 \u0111\u01a1n gi\u1ea3n nh\u1ea5t cho circular dependency. N\xf3 cho ph\xe9p NestJS bi\u1ebft r\u1eb1ng dependency s\u1ebd \u0111\u01b0\u1ee3c resolve sau, kh\xf4ng c\u1ea7n ph\u1ea3i resolve ngay l\u1eadp t\u1ee9c."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi b\u1ea1n c\u1ea7n gi\u1ea3i quy\u1ebft nhanh v\u1ea5n \u0111\u1ec1"}),"\n",(0,c.jsx)(n.li,{children:"Khi kh\xf4ng th\u1ec3 t\xe1i c\u1ea5u tr\xfac architecture ngay"}),"\n",(0,c.jsx)(n.li,{children:"Trong c\xe1c tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ea7n thi\u1ebft"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Gi\u1ea3i quy\u1ebft nhanh ch\xf3ng"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf4ng c\u1ea7n thay \u0111\u1ed5i logic code"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 implement"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Ch\u1ec9 che gi\u1ea5u v\u1ea5n \u0111\u1ec1, kh\xf4ng gi\u1ea3i quy\u1ebft g\u1ed1c r\u1ec5"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 g\xe2y kh\xf3 hi\u1ec3u cho developer kh\xe1c"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf4ng t\u1ed1t cho long-term maintenance"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-2-forward-reference-resolution",children:"Bi\u1ec3u \u0111\u1ed3 2: Forward Reference Resolution"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[UserService] --\x3e|forwardRef| B[EmailService]\n    B --\x3e|forwardRef| A\n    \n    C[Module Resolution] --\x3e|Step 1| D[Resolve UserService]\n    D --\x3e|Step 2| E[Resolve EmailService with forwardRef]\n    E --\x3e|Step 3| F[Complete Resolution]\n    \n    style A fill:#ff6b6b\n    style B fill:#4ecdc4\n    style C fill:#feca57\n    style D fill:#96ceb4\n    style E fill:#45b7d1\n    style F fill:#e8f5e8"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Step 1"}),": Resolve UserService tr\u01b0\u1edbc"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Step 2"}),": Resolve EmailService v\u1edbi forwardRef (delay resolution)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Step 3"}),": Ho\xe0n th\xe0nh resolution sau khi c\u1ea3 hai \u0111\u1ec1u s\u1eb5n s\xe0ng"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"forward-reference-v\u1edbi-services",children:"Forward Reference v\u1edbi Services"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Gi\u1ea3i ph\xe1p Forward Reference cho Services"',children:"// user.service.ts\n@Injectable()\nexport class UserService {\n  constructor(\n    @Inject(forwardRef(() => EmailService))\n    private emailService: EmailService\n  ) {}\n}\n\n// email.service.ts\n@Injectable()\nexport class EmailService {\n  constructor(\n    @Inject(forwardRef(() => UserService))\n    private userService: UserService\n  ) {}\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"forward-reference-v\u1edbi-modules",children:"Forward Reference v\u1edbi Modules"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Gi\u1ea3i ph\xe1p Forward Reference cho Modules"',children:"// user.module.ts\n@Module({\n  imports: [forwardRef(() => EmailModule)],\n  providers: [UserService],\n  exports: [UserService]\n})\nexport class UserModule {}\n\n// email.module.ts\n@Module({\n  imports: [forwardRef(() => UserModule)],\n  providers: [EmailService],\n  exports: [EmailService]\n})\nexport class EmailModule {}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"2-t\xe1i-c\u1ea5u-tr\xfac-architecture",children:"2. T\xe1i c\u1ea5u tr\xfac Architecture"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"T\xe1i c\u1ea5u tr\xfac Architecture"})," l\xe0 gi\u1ea3i ph\xe1p t\u1ed1t nh\u1ea5t v\xe0 b\u1ec1n v\u1eefng nh\u1ea5t. Thay v\xec che gi\u1ea5u v\u1ea5n \u0111\u1ec1, b\u1ea1n s\u1ebd thi\u1ebft k\u1ebf l\u1ea1i c\u1ea5u tr\xfac \u0111\u1ec3 lo\u1ea1i b\u1ecf ho\xe0n to\xe0n circular dependency."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi b\u1ea1n c\xf3 th\u1eddi gian \u0111\u1ec3 refactor"}),"\n",(0,c.jsx)(n.li,{children:"Khi mu\u1ed1n code d\u1ec5 maintain trong t\u01b0\u01a1ng lai"}),"\n",(0,c.jsx)(n.li,{children:"Khi l\xe0m vi\u1ec7c v\u1edbi team l\u1edbn"}),"\n",(0,c.jsx)(n.li,{children:"Khi \u1ee9ng d\u1ee5ng c\u1ea7n scale"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 t\u1eeb g\u1ed1c r\u1ec5"}),"\n",(0,c.jsx)(n.li,{children:"Code d\u1ec5 hi\u1ec3u v\xe0 maintain"}),"\n",(0,c.jsx)(n.li,{children:"T\u0103ng performance"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 test v\xe0 debug"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"C\u1ea7n th\u1eddi gian \u0111\u1ec3 implement"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 c\u1ea7n thay \u0111\u1ed5i nhi\u1ec1u code"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n hi\u1ec3u r\xf5 v\u1ec1 design patterns"}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"s\u1eed-d\u1ee5ng-event-pattern",children:"S\u1eed d\u1ee5ng Event Pattern"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Event Pattern"})," l\xe0 m\u1ed9t trong nh\u1eefng c\xe1ch t\u1ed1t nh\u1ea5t \u0111\u1ec3 lo\u1ea1i b\u1ecf circular dependency. Thay v\xec g\u1ecdi tr\u1ef1c ti\u1ebfp service, b\u1ea1n s\u1ebd emit events v\xe0 \u0111\u1ec3 c\xe1c service kh\xe1c l\u1eafng nghe v\xe0 x\u1eed l\xfd."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service A"})," th\u1ef1c hi\u1ec7n action v\xe0 emit event"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service B"})," l\u1eafng nghe event v\xe0 x\u1eed l\xfd"]}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf4ng c\xf3 dependency tr\u1ef1c ti\u1ebfp gi\u1eefa A v\xe0 B"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Lo\u1ea1i b\u1ecf ho\xe0n to\xe0n circular dependency"}),"\n",(0,c.jsx)(n.li,{children:"Loose coupling gi\u1eefa c\xe1c service"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 m\u1edf r\u1ed9ng v\xe0 th\xeam service m\u1edbi"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 handle async operations"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-3-event-pattern-architecture",children:"Bi\u1ec3u \u0111\u1ed3 3: Event Pattern Architecture"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[UserService] --\x3e|emit event| B[Event Bus]\n    B --\x3e|listen| C[EmailService]\n    B --\x3e|listen| D[NotificationService]\n    B --\x3e|listen| E[LoggingService]\n    \n    F[User Created] --\x3e|triggers| G[user.created event]\n    G --\x3e|handled by| C\n    G --\x3e|handled by| D\n    G --\x3e|handled by| E\n    \n    style A fill:#ff6b6b\n    style B fill:#feca57\n    style C fill:#4ecdc4\n    style D fill:#45b7d1\n    style E fill:#96ceb4\n    style F fill:#e8f5e8\n    style G fill:#f3e5f5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"UserService"})," emit event thay v\xec g\u1ecdi tr\u1ef1c ti\u1ebfp c\xe1c service kh\xe1c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Event Bus"})," l\xe0m trung gian, kh\xf4ng c\xf3 dependency tr\u1ef1c ti\u1ebfp"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"C\xe1c Service"})," l\u1eafng nghe event v\xe0 x\u1eed l\xfd \u0111\u1ed9c l\u1eadp"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Loose coupling"})," - kh\xf4ng bi\u1ebft v\u1ec1 nhau"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Event Pattern \u0111\u1ec3 tr\xe1nh Circular Dependency"',children:"// user.service.ts\n@Injectable()\nexport class UserService {\n  constructor(\n    private eventEmitter: EventEmitter2,\n    private userRepository: UserRepository\n  ) {}\n  \n  async createUser(userData: CreateUserDto) {\n    const user = await this.userRepository.save(userData);\n    \n    // Emit event thay v\xec g\u1ecdi tr\u1ef1c ti\u1ebfp\n    this.eventEmitter.emit('user.created', user);\n    \n    return user;\n  }\n}\n\n// email.service.ts\n@Injectable()\nexport class EmailService {\n  constructor(private eventEmitter: EventEmitter2) {}\n  \n  @OnEvent('user.created')\n  async handleUserCreated(user: User) {\n    await this.sendWelcomeEmail(user.email);\n  }\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"s\u1eed-d\u1ee5ng-interface-segregation",children:"S\u1eed d\u1ee5ng Interface Segregation"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Interface Segregation"})," l\xe0 pattern gi\xfap t\xe1ch bi\u1ec7t c\xe1c interface th\xe0nh c\xe1c ph\u1ea7n nh\u1ecf h\u01a1n, m\u1ed7i interface ch\u1ec9 ch\u1ee9a nh\u1eefng method c\u1ea7n thi\u1ebft. \u0110i\u1ec1u n\xe0y gi\xfap gi\u1ea3m coupling v\xe0 tr\xe1nh circular dependency."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"\u0110\u1ecbnh ngh\u0129a c\xe1c interface nh\u1ecf, c\u1ee5 th\u1ec3"}),"\n",(0,c.jsx)(n.li,{children:"M\u1ed7i service ch\u1ec9 implement nh\u1eefng interface c\u1ea7n thi\u1ebft"}),"\n",(0,c.jsx)(n.li,{children:"S\u1eed d\u1ee5ng dependency injection v\u1edbi interface thay v\xec concrete class"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Gi\u1ea3m coupling gi\u1eefa c\xe1c service"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 test v\u1edbi mock objects"}),"\n",(0,c.jsx)(n.li,{children:"Code linh ho\u1ea1t v\xe0 d\u1ec5 m\u1edf r\u1ed9ng"}),"\n",(0,c.jsx)(n.li,{children:"Tu\xe2n th\u1ee7 SOLID principles"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"C\u1ea7n t\u1ea1o nhi\u1ec1u interface"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 ph\u1ee9c t\u1ea1p h\u01a1n ban \u0111\u1ea7u"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n hi\u1ec3u r\xf5 v\u1ec1 dependency injection"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-4-interface-segregation-pattern",children:"Bi\u1ec3u \u0111\u1ed3 4: Interface Segregation Pattern"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[IUserService] --\x3e|implements| B[UserService]\n    C[IEmailService] --\x3e|implements| D[EmailService]\n    E[INotificationService] --\x3e|implements| F[NotificationService]\n    \n    G[UserController] --\x3e|depends on| A\n    G --\x3e|depends on| C\n    H[EmailController] --\x3e|depends on| A\n    H --\x3e|depends on| E\n    \n    style A fill:#e8f5e8\n    style B fill:#c8e6c9\n    style C fill:#fff3e0\n    style D fill:#ffe0b2\n    style E fill:#f3e5f5\n    style F fill:#e1bee7\n    style G fill:#ff6b6b\n    style H fill:#4ecdc4"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Controllers"})," ch\u1ec9 ph\u1ee5 thu\u1ed9c v\xe0o ",(0,c.jsx)(n.strong,{children:"Interfaces"}),", kh\xf4ng ph\u1ee5 thu\u1ed9c v\xe0o ",(0,c.jsx)(n.strong,{children:"Concrete Classes"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Services"})," implement c\xe1c ",(0,c.jsx)(n.strong,{children:"Interfaces"})," c\u1ee5 th\u1ec3"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Dependency Inversion"})," - ph\u1ee5 thu\u1ed9c v\xe0o abstraction, kh\xf4ng ph\u1ee5 thu\u1ed9c v\xe0o implementation"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Interface Segregation Pattern"',children:"// interfaces/user.interface.ts\nexport interface IUserService {\n  findByEmail(email: string): Promise<User>;\n  createUser(userData: CreateUserDto): Promise<User>;\n}\n\nexport interface IEmailService {\n  sendWelcomeEmail(email: string): Promise<void>;\n}\n\n// user.service.ts\n@Injectable()\nexport class UserService implements IUserService {\n  constructor(\n    @Inject('EMAIL_SERVICE')\n    private emailService: IEmailService\n  ) {}\n}\n\n// email.service.ts\n@Injectable()\nexport class EmailService implements IEmailService {\n  constructor(\n    @Inject('USER_SERVICE')\n    private userService: IUserService\n  ) {}\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"3-s\u1eed-d\u1ee5ng-factory-pattern",children:"3. S\u1eed d\u1ee5ng Factory Pattern"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Factory Pattern"})," cho ph\xe9p b\u1ea1n t\u1ea1o objects m\u1ed9t c\xe1ch linh ho\u1ea1t, c\xf3 th\u1ec3 inject dependencies theo th\u1ee9 t\u1ef1 mong mu\u1ed1n \u0111\u1ec3 tr\xe1nh circular dependency."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,c.jsx)(n.code,{children:"useFactory"})," trong module configuration"]}),"\n",(0,c.jsx)(n.li,{children:"Factory function nh\u1eadn dependencies \u0111\xe3 \u0111\u01b0\u1ee3c resolve"}),"\n",(0,c.jsx)(n.li,{children:"T\u1ea1o service m\u1edbi v\u1edbi dependencies \u0111\xe3 c\xf3 s\u1eb5n"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n ki\u1ec3m so\xe1t c\xe1ch t\u1ea1o service"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n inject dependencies theo th\u1ee9 t\u1ef1 c\u1ee5 th\u1ec3"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n logic ph\u1ee9c t\u1ea1p \u0111\u1ec3 kh\u1edfi t\u1ea1o service"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Ki\u1ec3m so\xe1t ho\xe0n to\xe0n qu\xe1 tr\xecnh kh\u1edfi t\u1ea1o"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 th\xeam logic ph\u1ee9c t\u1ea1p"}),"\n",(0,c.jsx)(n.li,{children:"Linh ho\u1ea1t trong vi\u1ec7c inject dependencies"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Code ph\u1ee9c t\u1ea1p h\u01a1n"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf3 debug khi c\xf3 l\u1ed7i"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n hi\u1ec3u r\xf5 v\u1ec1 dependency injection lifecycle"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-5-factory-pattern",children:"Bi\u1ec3u \u0111\u1ed3 5: Factory Pattern"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[UserModule] --\x3e|provides| B[UserService]\n    A --\x3e|provides| C[EmailService Factory]\n    \n    B --\x3e|injected into| C\n    C --\x3e|creates| D[EmailService Instance]\n    \n    E[Module Configuration] --\x3e|useFactory| C\n    E --\x3e|inject| B\n    \n    style A fill:#e8f5e8\n    style B fill:#4ecdc4\n    style C fill:#feca57\n    style D fill:#45b7d1\n    style E fill:#f3e5f5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"UserModule"})," cung c\u1ea5p c\u1ea3 ",(0,c.jsx)(n.strong,{children:"UserService"})," v\xe0 ",(0,c.jsx)(n.strong,{children:"EmailService Factory"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Factory"})," nh\u1eadn ",(0,c.jsx)(n.strong,{children:"UserService"})," \u0111\xe3 \u0111\u01b0\u1ee3c inject"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Factory"})," t\u1ea1o ra ",(0,c.jsx)(n.strong,{children:"EmailService Instance"})," v\u1edbi dependency \u0111\xe3 c\xf3 s\u1eb5n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Module Configuration"})," s\u1eed d\u1ee5ng ",(0,c.jsx)(n.code,{children:"useFactory"})," \u0111\u1ec3 ki\u1ec3m so\xe1t qu\xe1 tr\xecnh t\u1ea1o service"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Factory Pattern \u0111\u1ec3 tr\xe1nh Circular Dependency"',children:"// user.module.ts\n@Module({\n  providers: [\n    UserService,\n    {\n      provide: 'EMAIL_SERVICE',\n      useFactory: (userService: UserService) => {\n        return new EmailService(userService);\n      },\n      inject: [UserService]\n    }\n  ],\n  exports: [UserService, 'EMAIL_SERVICE']\n})\nexport class UserModule {}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"4-s\u1eed-d\u1ee5ng-shared-module",children:"4. S\u1eed d\u1ee5ng Shared Module"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Shared Module"})," l\xe0 gi\u1ea3i ph\xe1p t\u1ea1o ra m\u1ed9t module chung ch\u1ee9a c\xe1c service, provider, ho\u1eb7c utility m\xe0 nhi\u1ec1u module kh\xe1c c\u1ea7n s\u1eed d\u1ee5ng. \u0110i\u1ec1u n\xe0y gi\xfap tr\xe1nh circular dependency b\u1eb1ng c\xe1ch t\u1eadp trung c\xe1c dependencies chung v\xe0o m\u1ed9t n\u01a1i."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"T\u1ea1o m\u1ed9t module chung (SharedModule/CommonModule)"}),"\n",(0,c.jsx)(n.li,{children:"\u0110\u1eb7t c\xe1c service c\u1ea7n thi\u1ebft v\xe0o module n\xe0y"}),"\n",(0,c.jsx)(n.li,{children:"C\xe1c module kh\xe1c import SharedModule thay v\xec import l\u1eabn nhau"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf4ng c\xf3 dependency tr\u1ef1c ti\u1ebfp gi\u1eefa c\xe1c module"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi nhi\u1ec1u module c\u1ea7n c\xf9ng m\u1ed9t service"}),"\n",(0,c.jsx)(n.li,{children:"Khi mu\u1ed1n t\xe1i s\u1eed d\u1ee5ng code"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n tr\xe1nh duplicate code"}),"\n",(0,c.jsx)(n.li,{children:"Khi mu\u1ed1n qu\u1ea3n l\xfd dependencies t\u1eadp trung"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Lo\u1ea1i b\u1ecf ho\xe0n to\xe0n circular dependency"}),"\n",(0,c.jsx)(n.li,{children:"Code d\u1ec5 maintain v\xe0 t\xe1i s\u1eed d\u1ee5ng"}),"\n",(0,c.jsx)(n.li,{children:"Qu\u1ea3n l\xfd dependencies t\u1eadp trung"}),"\n",(0,c.jsx)(n.li,{children:"Tu\xe2n th\u1ee7 DRY principle"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 test v\xe0 debug"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 t\u1ea1o ra module qu\xe1 l\u1edbn"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n qu\u1ea3n l\xfd c\u1ea9n th\u1eadn \u0111\u1ec3 tr\xe1nh tight coupling"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 g\xe2y kh\xf3 kh\u0103n khi refactor"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-7-shared-module-pattern",children:"Bi\u1ec3u \u0111\u1ed3 7: Shared Module Pattern"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[SharedModule] --\x3e|provides| B[CommonService]\n    A --\x3e|provides| C[UtilityService]\n    A --\x3e|provides| D[ConfigService]\n    \n    E[UserModule] --\x3e|imports| A\n    F[EmailModule] --\x3e|imports| A\n    G[NotificationModule] --\x3e|imports| A\n    \n    H[No Direct Dependencies] --\x3e|between| E\n    H --\x3e|between| F\n    H --\x3e|between| G\n    \n    style A fill:#feca57\n    style B fill:#4ecdc4\n    style C fill:#45b7d1\n    style D fill:#96ceb4\n    style E fill:#ff6b6b\n    style F fill:#e8f5e8\n    style G fill:#f3e5f5\n    style H fill:#e0f2f1"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"SharedModule"})," cung c\u1ea5p c\xe1c service chung cho t\u1ea5t c\u1ea3 modules"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"C\xe1c Module"})," ch\u1ec9 import SharedModule, kh\xf4ng import l\u1eabn nhau"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Kh\xf4ng c\xf3 Direct Dependencies"})," gi\u1eefa c\xe1c module"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Centralized dependencies"})," - qu\u1ea3n l\xfd t\u1eadp trung"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Shared Module Pattern"',children:"// shared/shared.module.ts\n@Module({\n  providers: [\n    CommonService,\n    UtilityService,\n    ConfigService,\n    LoggerService,\n    CacheService\n  ],\n  exports: [\n    CommonService,\n    UtilityService,\n    ConfigService,\n    LoggerService,\n    CacheService\n  ]\n})\nexport class SharedModule {}\n\n// user/user.module.ts\n@Module({\n  imports: [SharedModule], // Import shared module\n  providers: [UserService],\n  exports: [UserService]\n})\nexport class UserModule {}\n\n// email/email.module.ts\n@Module({\n  imports: [SharedModule], // Import shared module\n  providers: [EmailService],\n  exports: [EmailService]\n})\nexport class EmailModule {}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"5-s\u1eed-d\u1ee5ng-lazy-loading",children:"5. S\u1eed d\u1ee5ng Lazy Loading"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Lazy Loading"})," l\xe0 k\u1ef9 thu\u1eadt ch\u1ec9 load service khi c\u1ea7n thi\u1ebft, thay v\xec load ngay khi kh\u1edfi t\u1ea1o. \u0110i\u1ec1u n\xe0y gi\xfap tr\xe1nh circular dependency b\u1eb1ng c\xe1ch delay vi\u1ec7c resolve dependencies."]}),"\n",(0,c.jsx)(n.h3,{id:"6--gi\u1ea3i-ph\xe1p-t\u1ed1i-\u01b0u-domain-driven-design-v\u1edbi-clean-architecture",children:"6. \ud83d\ude80 Gi\u1ea3i ph\xe1p T\u1ed1i \u01b0u: Domain-Driven Design v\u1edbi Clean Architecture"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Domain-Driven Design (DDD) v\u1edbi Clean Architecture"})," l\xe0 gi\u1ea3i ph\xe1p t\u1ed1i \u01b0u nh\u1ea5t \u0111\u1ec3 tr\xe1nh circular dependency. \u0110\xe2y kh\xf4ng ch\u1ec9 l\xe0 c\xe1ch gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1, m\xe0 c\xf2n l\xe0 ph\u01b0\u01a1ng ph\xe1p thi\u1ebft k\u1ebf architecture b\u1ec1n v\u1eefng v\xe0 scalable."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Domain Layer"})," - Ch\u1ee9a business logic v\xe0 entities"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Application Layer"})," - Ch\u1ee9a use cases v\xe0 application services"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Infrastructure Layer"})," - Ch\u1ee9a external concerns (database, external APIs)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Dependency Rule"}),": Ch\u1ec9 c\xf3 th\u1ec3 ph\u1ee5 thu\u1ed9c t\u1eeb ngo\xe0i v\xe0o trong"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi x\xe2y d\u1ef1ng \u1ee9ng d\u1ee5ng enterprise"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n architecture scalable v\xe0 maintainable"}),"\n",(0,c.jsx)(n.li,{children:"Khi l\xe0m vi\u1ec7c v\u1edbi team l\u1edbn"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n code quality cao"}),"\n",(0,c.jsx)(n.li,{children:"Khi mu\u1ed1n tr\xe1nh ho\xe0n to\xe0n circular dependency"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Lo\u1ea1i b\u1ecf 100% circular dependency"})}),"\n",(0,c.jsx)(n.li,{children:"Architecture r\xf5 r\xe0ng v\xe0 d\u1ec5 hi\u1ec3u"}),"\n",(0,c.jsx)(n.li,{children:"Code d\u1ec5 test, maintain v\xe0 m\u1edf r\u1ed9ng"}),"\n",(0,c.jsx)(n.li,{children:"Tu\xe2n th\u1ee7 SOLID principles"}),"\n",(0,c.jsx)(n.li,{children:"D\u1ec5 scale v\xe0 refactor"}),"\n",(0,c.jsx)(n.li,{children:"Business logic \u0111\u01b0\u1ee3c t\xe1ch bi\u1ec7t ho\xe0n to\xe0n"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"C\u1ea7n th\u1eddi gian \u0111\u1ec3 implement"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n hi\u1ec3u r\xf5 v\u1ec1 DDD concepts"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 over-engineer cho project nh\u1ecf"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n team c\xf3 kinh nghi\u1ec7m"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-8-ddd--clean-architecture",children:"Bi\u1ec3u \u0111\u1ed3 8: DDD + Clean Architecture"}),"\n",(0,c.jsx)(n.mermaid,{value:'graph TD\n    subgraph "Infrastructure Layer"\n        A[Database]\n        B[External APIs]\n        C[Message Queue]\n    end\n    \n    subgraph "Application Layer"\n        D[User Use Cases]\n        E[Email Use Cases]\n        F[Notification Use Cases]\n    end\n    \n    subgraph "Domain Layer"\n        G[User Entity]\n        H[Email Entity]\n        I[Notification Entity]\n        J[Domain Services]\n    end\n    \n    A --\x3e|implements| K[Repository Interface]\n    B --\x3e|implements| L[External Service Interface]\n    C --\x3e|implements| M[Message Interface]\n    \n    D --\x3e|uses| G\n    E --\x3e|uses| H\n    F --\x3e|uses| I\n    F --\x3e|uses| J\n    \n    K --\x3e|depends on| G\n    L --\x3e|depends on| H\n    M --\x3e|depends on| I\n    \n    style A fill:#ff6b6b\n    style B fill:#4ecdc4\n    style C fill:#45b7d1\n    style D fill:#96ceb4\n    style E fill:#feca57\n    style F fill:#e8f5e8\n    style G fill:#f3e5f5\n    style H fill:#e0f2f1\n    style I fill:#fff3e0\n    style J fill:#fce4ec\n    style K fill:#ff6b6b\n    style L fill:#4ecdc4\n    style M fill:#45b7d1'}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"3 Layer Architecture"}),": Infrastructure \u2192 Application \u2192 Domain"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Dependency Rule"}),": Ch\u1ec9 ph\u1ee5 thu\u1ed9c t\u1eeb ngo\xe0i v\xe0o trong"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Domain Layer"}),": Kh\xf4ng ph\u1ee5 thu\u1ed9c v\xe0o b\u1ea5t k\u1ef3 layer n\xe0o kh\xe1c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Infrastructure Layer"}),": Implement c\xe1c interface t\u1eeb Application Layer"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Application Layer"}),": Orchestrate business logic v\xe0 use cases"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="DDD v\u1edbi Clean Architecture"',children:"// Domain Layer - User Entity\nexport class User {\n  constructor(\n    private id: string,\n    private email: string,\n    private name: string\n  ) {}\n  \n  // Business logic methods\n  changeEmail(newEmail: string): void {\n    if (this.isValidEmail(newEmail)) {\n      this.email = newEmail;\n    }\n  }\n  \n  private isValidEmail(email: string): boolean {\n    return email.includes('@');\n  }\n}\n\n// Domain Layer - User Repository Interface\nexport interface IUserRepository {\n  findById(id: string): Promise<User>;\n  save(user: User): Promise<void>;\n}\n\n// Application Layer - User Use Case\n@Injectable()\nexport class CreateUserUseCase {\n  constructor(\n    private userRepository: IUserRepository,\n    private eventBus: IEventBus\n  ) {}\n  \n  async execute(command: CreateUserCommand): Promise<User> {\n    const user = new User(\n      command.id,\n      command.email,\n      command.name\n    );\n    \n    await this.userRepository.save(user);\n    \n    // Emit domain event\n    this.eventBus.publish(new UserCreatedEvent(user));\n    \n    return user;\n  }\n}\n\n// Infrastructure Layer - User Repository Implementation\n@Injectable()\nexport class UserRepository implements IUserRepository {\n  constructor(private dataSource: DataSource) {}\n  \n  async findById(id: string): Promise<User> {\n    const userData = await this.dataSource\n      .createQueryBuilder()\n      .select('*')\n      .from('users', 'u')\n      .where('u.id = :id', { id })\n      .getOne();\n    \n    return new User(\n      userData.id,\n      userData.email,\n      userData.name\n    );\n  }\n  \n  async save(user: User): Promise<void> {\n    // Save to database\n  }\n}\n\n// Module Configuration\n@Module({\n  providers: [\n    // Application Layer\n    CreateUserUseCase,\n    // Infrastructure Layer\n    { provide: 'IUserRepository', useClass: UserRepository },\n    { provide: 'IEventBus', useClass: EventBus }\n  ],\n  exports: [CreateUserUseCase]\n})\nexport class UserModule {}\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\ud83c\udfaf T\u1ea1i sao \u0111\xe2y l\xe0 gi\u1ea3i ph\xe1p t\u1ed1i \u01b0u?"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Dependency Direction R\xf5 r\xe0ng"}),": Ch\u1ec9 c\xf3 th\u1ec3 ph\u1ee5 thu\u1ed9c t\u1eeb ngo\xe0i v\xe0o trong"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Business Logic T\xe1ch bi\u1ec7t"}),": Domain layer kh\xf4ng ph\u1ee5 thu\u1ed9c v\xe0o b\u1ea5t k\u1ef3 layer n\xe0o kh\xe1c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Interface Segregation"}),": M\u1ed7i layer ch\u1ec9 bi\u1ebft v\u1ec1 interface, kh\xf4ng bi\u1ebft v\u1ec1 implementation"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Event-Driven"}),": S\u1eed d\u1ee5ng domain events \u0111\u1ec3 giao ti\u1ebfp gi\u1eefa c\xe1c bounded context"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Testability"}),": D\u1ec5 d\xe0ng mock v\xe0 test t\u1eebng layer ri\xeang bi\u1ec7t"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"-c\xe1ch-x\u1eed-l\xfd-circular-dependency-step-by-step",children:"\ud83d\udd27 C\xe1ch X\u1eed L\xfd Circular Dependency Step-by-Step"}),"\n",(0,c.jsx)(n.h3,{id:"b\u01b0\u1edbc-1-ph\xe2n-t\xedch-v\xe0-x\xe1c-\u0111\u1ecbnh-v\u1ea5n-\u0111\u1ec1",children:"B\u01b0\u1edbc 1: Ph\xe2n t\xedch v\xe0 X\xe1c \u0111\u1ecbnh V\u1ea5n \u0111\u1ec1"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"1.1 X\xe1c \u0111\u1ecbnh Circular Dependency:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# L\u1ed7i th\u01b0\u1eddng g\u1eb7p\nError: Nest can't resolve dependencies of the UserService (?). \nPlease make sure that the argument EmailService at index [0] is available in the UserModule context.\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"1.2 V\u1ebd Dependency Graph:"})}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[UserService] --\x3e B[EmailService]\n    B --\x3e A\n    \n    style A fill:#ff6b6b\n    style B fill:#4ecdc4"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"1.3 X\xe1c \u0111\u1ecbnh Nguy\xean nh\xe2n:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Service A c\u1ea7n Service B \u0111\u1ec3 ho\u1ea1t \u0111\u1ed9ng"}),"\n",(0,c.jsx)(n.li,{children:"Service B l\u1ea1i c\u1ea7n Service A \u0111\u1ec3 ho\u1ea1t \u0111\u1ed9ng"}),"\n",(0,c.jsx)(n.li,{children:"T\u1ea1o th\xe0nh v\xf2ng l\u1eb7p v\xf4 h\u1ea1n"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"b\u01b0\u1edbc-2-ch\u1ecdn-gi\u1ea3i-ph\xe1p-ph\xf9-h\u1ee3p",children:"B\u01b0\u1edbc 2: Ch\u1ecdn Gi\u1ea3i ph\xe1p Ph\xf9 h\u1ee3p"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"2.1 Quick Fix (T\u1ea1m th\u1eddi):"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,c.jsx)(n.strong,{children:"Forward Reference"})," \u0111\u1ec3 gi\u1ea3i quy\u1ebft nhanh"]}),"\n",(0,c.jsx)(n.li,{children:"Ch\u1ec9 d\xf9ng khi c\u1ea7n fix g\u1ea5p, kh\xf4ng c\xf3 th\u1eddi gian refactor"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"2.2 Long-term Solution (B\u1ec1n v\u1eefng):"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Event Pattern"})," - Lo\u1ea1i b\u1ecf dependency tr\u1ef1c ti\u1ebfp"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Shared Module"})," - T\u1eadp trung dependencies chung"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"DDD + Clean Architecture"})," - Gi\u1ea3i ph\xe1p t\u1ed1i \u01b0u nh\u1ea5t"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"b\u01b0\u1edbc-3-implement-gi\u1ea3i-ph\xe1p",children:"B\u01b0\u1edbc 3: Implement Gi\u1ea3i ph\xe1p"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"3.1 V\u1edbi Event Pattern:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Step-by-Step Implementation"',children:"// B\u01b0\u1edbc 1: T\u1ea1o Event\nexport class UserCreatedEvent {\n  constructor(public readonly user: User) {}\n}\n\n// B\u01b0\u1edbc 2: S\u1eeda UserService\n@Injectable()\nexport class UserService {\n  constructor(\n    private eventEmitter: EventEmitter2, // Thay v\xec EmailService\n    private userRepository: UserRepository\n  ) {}\n  \n  async createUser(userData: CreateUserDto) {\n    const user = await this.userRepository.save(userData);\n    \n    // Emit event thay v\xec g\u1ecdi tr\u1ef1c ti\u1ebfp\n    this.eventEmitter.emit('user.created', new UserCreatedEvent(user));\n    \n    return user;\n  }\n}\n\n// B\u01b0\u1edbc 3: S\u1eeda EmailService\n@Injectable()\nexport class EmailService {\n  // Kh\xf4ng c\xf2n inject UserService\n  \n  @OnEvent('user.created')\n  async handleUserCreated(event: UserCreatedEvent) {\n    await this.sendWelcomeEmail(event.user.email);\n  }\n}\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"3.2 V\u1edbi Shared Module:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Step-by-Step Implementation"',children:"// B\u01b0\u1edbc 1: T\u1ea1o SharedModule\n@Module({\n  providers: [\n    CommonService,\n    LoggerService,\n    ConfigService\n  ],\n  exports: [\n    CommonService,\n    LoggerService,\n    ConfigService\n  ]\n})\nexport class SharedModule {}\n\n// B\u01b0\u1edbc 2: S\u1eeda UserModule\n@Module({\n  imports: [SharedModule], // Import shared thay v\xec EmailModule\n  providers: [UserService],\n  exports: [UserService]\n})\nexport class UserModule {}\n\n// B\u01b0\u1edbc 3: S\u1eeda EmailModule\n@Module({\n  imports: [SharedModule], // Import shared thay v\xec UserModule\n  providers: [EmailService],\n  exports: [EmailService]\n})\nexport class EmailModule {}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"b\u01b0\u1edbc-4-test-v\xe0-verify",children:"B\u01b0\u1edbc 4: Test v\xe0 Verify"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"4.1 Unit Test:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Testing Event Pattern"',children:"describe('UserService', () => {\n  let service: UserService;\n  let eventEmitter: EventEmitter2;\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        UserService,\n        {\n          provide: EventEmitter2,\n          useValue: {\n            emit: jest.fn()\n          }\n        }\n      ]\n    }).compile();\n\n    service = module.get<UserService>(UserService);\n    eventEmitter = module.get<EventEmitter2>(EventEmitter2);\n  });\n\n  it('should emit user.created event when creating user', async () => {\n    const userData = { email: 'test@example.com', name: 'Test' };\n    \n    await service.createUser(userData);\n    \n    expect(eventEmitter.emit).toHaveBeenCalledWith(\n      'user.created',\n      expect.any(UserCreatedEvent)\n    );\n  });\n});\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"4.2 Integration Test:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Integration Testing"',children:"describe('User and Email Integration', () => {\n  let app: INestApplication;\n\n  beforeEach(async () => {\n    const moduleFixture: TestingModule = await Test.createTestingModule({\n      imports: [UserModule, EmailModule, SharedModule]\n    }).compile();\n\n    app = moduleFixture.createNestApplication();\n    await app.init();\n  });\n\n  it('should handle user creation flow without circular dependency', async () => {\n    // Test to\xe0n b\u1ed9 flow\n    const userService = app.get(UserService);\n    const emailService = app.get(EmailService);\n    \n    // Verify kh\xf4ng c\xf3 circular dependency\n    expect(userService).toBeDefined();\n    expect(emailService).toBeDefined();\n  });\n});\n"})}),"\n",(0,c.jsx)(n.h3,{id:"b\u01b0\u1edbc-5-monitor-v\xe0-maintain",children:"B\u01b0\u1edbc 5: Monitor v\xe0 Maintain"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"5.1 Dependency Graph Monitoring:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Dependency Monitor"',children:"@Injectable()\nexport class DependencyMonitorService {\n  constructor(private moduleRef: ModuleRef) {}\n\n  generateDependencyReport(): any {\n    // T\u1ea1o b\xe1o c\xe1o dependencies\n    return {\n      modules: this.getModuleDependencies(),\n      services: this.getServiceDependencies(),\n      circularDeps: this.detectCircularDependencies()\n    };\n  }\n\n  private detectCircularDependencies(): string[] {\n    // Logic ph\xe1t hi\u1ec7n circular dependency\n    return [];\n  }\n}\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"5.2 Health Check:"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Health Check"',children:"@Controller('health')\nexport class HealthController {\n  @Get('dependencies')\n  async checkDependencies() {\n    // Ki\u1ec3m tra health c\u1ee7a dependencies\n    return {\n      status: 'healthy',\n      circularDependencies: 0,\n      totalDependencies: 10\n    };\n  }\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"-checklist-x\u1eed-l\xfd-circular-dependency",children:"\ud83d\udccb Checklist X\u1eed L\xfd Circular Dependency"}),"\n",(0,c.jsxs)(n.h3,{id:"-tr\u01b0\u1edbc-khi-implement",children:["\u2705 ",(0,c.jsx)(n.strong,{children:"Tr\u01b0\u1edbc khi Implement:"})]}),"\n",(0,c.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","X\xe1c \u0111\u1ecbnh r\xf5 circular dependency"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","V\u1ebd dependency graph"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Ch\u1ecdn gi\u1ea3i ph\xe1p ph\xf9 h\u1ee3p"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Backup code hi\u1ec7n t\u1ea1i"]}),"\n"]}),"\n",(0,c.jsxs)(n.h3,{id:"-trong-qu\xe1-tr\xecnh-implement",children:["\u2705 ",(0,c.jsx)(n.strong,{children:"Trong qu\xe1 tr\xecnh Implement:"})]}),"\n",(0,c.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Implement t\u1eebng b\u01b0\u1edbc m\u1ed9t"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test sau m\u1ed7i b\u01b0\u1edbc"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Commit code th\u01b0\u1eddng xuy\xean"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Document thay \u0111\u1ed5i"]}),"\n"]}),"\n",(0,c.jsxs)(n.h3,{id:"-sau-khi-implement",children:["\u2705 ",(0,c.jsx)(n.strong,{children:"Sau khi Implement:"})]}),"\n",(0,c.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test to\xe0n b\u1ed9 functionality"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Performance test"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Update documentation"]}),"\n",(0,c.jsxs)(n.li,{className:"task-list-item",children:[(0,c.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Train team members"]}),"\n"]}),"\n",(0,c.jsxs)(n.h2,{id:"-k\u1ebft-qu\u1ea3-mong-\u0111\u1ee3i",children:["\ud83c\udfaf ",(0,c.jsx)(n.strong,{children:"K\u1ebft qu\u1ea3 mong \u0111\u1ee3i:"})]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Kh\xf4ng c\xf2n l\u1ed7i circular dependency"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"\u1ee8ng d\u1ee5ng kh\u1edfi \u0111\u1ed9ng th\xe0nh c\xf4ng"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Code d\u1ec5 maintain v\xe0 m\u1edf r\u1ed9ng"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Performance \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Team hi\u1ec3u r\xf5 architecture m\u1edbi"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng:"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"Service kh\xf4ng inject dependency ngay trong constructor"}),"\n",(0,c.jsxs)(n.li,{children:["S\u1eed d\u1ee5ng ",(0,c.jsx)(n.code,{children:"ModuleRef"})," \u0111\u1ec3 l\u1ea5y service khi c\u1ea7n"]}),"\n",(0,c.jsx)(n.li,{children:'Service \u0111\u01b0\u1ee3c load "lazy" - ch\u1ec9 khi th\u1ef1c s\u1ef1 c\u1ea7n d\xf9ng'}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Khi n\xe0o s\u1eed d\u1ee5ng:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n tr\xe1nh circular dependency"}),"\n",(0,c.jsx)(n.li,{children:"Khi service kh\xf4ng c\u1ea7n thi\u1ebft ngay l\u1eadp t\u1ee9c"}),"\n",(0,c.jsx)(n.li,{children:"Khi mu\u1ed1n t\u1ed1i \u01b0u performance"}),"\n",(0,c.jsx)(n.li,{children:"Khi c\u1ea7n ki\u1ec3m so\xe1t lifecycle c\u1ee7a dependencies"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u01afu \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Gi\u1ea3i quy\u1ebft circular dependency hi\u1ec7u qu\u1ea3"}),"\n",(0,c.jsx)(n.li,{children:"T\u1ed1i \u01b0u memory usage"}),"\n",(0,c.jsx)(n.li,{children:"Linh ho\u1ea1t trong vi\u1ec7c qu\u1ea3n l\xfd dependencies"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 handle dynamic dependencies"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Nh\u01b0\u1ee3c \u0111i\u1ec3m:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Code ph\u1ee9c t\u1ea1p h\u01a1n"}),"\n",(0,c.jsx)(n.li,{children:"C\xf3 th\u1ec3 g\xe2y l\u1ed7i runtime n\u1ebfu kh\xf4ng handle \u0111\xfang"}),"\n",(0,c.jsx)(n.li,{children:"Kh\xf3 debug khi c\xf3 v\u1ea5n \u0111\u1ec1"}),"\n",(0,c.jsx)(n.li,{children:"C\u1ea7n hi\u1ec3u r\xf5 v\u1ec1 ModuleRef v\xe0 lifecycle"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"bi\u1ec3u-\u0111\u1ed3-6-lazy-loading-pattern",children:"Bi\u1ec3u \u0111\u1ed3 6: Lazy Loading Pattern"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[UserService] --\x3e|constructor| B[ModuleRef]\n    A --\x3e|lazy load| C[EmailService]\n    \n    D[Request comes in] --\x3e|triggers| E[createUser method]\n    E --\x3e|calls| F[getEmailService]\n    F --\x3e|gets from| B\n    B --\x3e|provides| C\n    \n    G[Service Resolution] --\x3e|delayed until| H[actual usage]\n    \n    style A fill:#ff6b6b\n    style B fill:#feca57\n    style C fill:#4ecdc4\n    style D fill:#e8f5e8\n    style E fill:#96ceb4\n    style F fill:#45b7d1\n    style G fill:#f3e5f5\n    style H fill:#e0f2f1"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"UserService"})," ch\u1ec9 nh\u1eadn ",(0,c.jsx)(n.strong,{children:"ModuleRef"})," trong constructor"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"EmailService"}),' \u0111\u01b0\u1ee3c load "lazy" khi th\u1ef1c s\u1ef1 c\u1ea7n d\xf9ng']}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Service Resolution"})," b\u1ecb delay cho \u0111\u1ebfn khi ",(0,c.jsx)(n.strong,{children:"actual usage"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"ModuleRef"})," cung c\u1ea5p service khi c\u1ea7n thi\u1ebft"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Lazy Loading \u0111\u1ec3 tr\xe1nh Circular Dependency"',children:"// user.service.ts\n@Injectable()\nexport class UserService {\n  private emailService: EmailService;\n  \n  constructor(private moduleRef: ModuleRef) {}\n  \n  private getEmailService(): EmailService {\n    if (!this.emailService) {\n      this.emailService = this.moduleRef.get(EmailService, { strict: false });\n    }\n    return this.emailService;\n  }\n  \n  async createUser(userData: CreateUserDto) {\n    const user = await this.userRepository.save(userData);\n    \n    // Lazy load EmailService\n    const emailService = this.getEmailService();\n    await emailService.sendWelcomeEmail(user.email);\n    \n    return user;\n  }\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"best-practices-\u0111\u1ec3-tr\xe1nh-circular-dependency",children:"Best Practices \u0111\u1ec3 tr\xe1nh Circular Dependency"}),"\n",(0,c.jsx)(n.h3,{id:"1-thi\u1ebft-k\u1ebf-architecture",children:"1. Thi\u1ebft k\u1ebf Architecture"}),"\n",(0,c.jsx)(n.mermaid,{value:"graph TD\n    A[Domain Layer] --\x3e B[Application Layer]\n    B --\x3e C[Infrastructure Layer]\n    \n    D[User Domain] --\x3e E[Email Domain]\n    E --\x3e F[Notification Domain]\n    \n    style A fill:#e8f5e8\n    style B fill:#fff3e0\n    style C fill:#fce4ec\n    style D fill:#e3f2fd\n    style E fill:#f3e5f5\n    style F fill:#e0f2f1"}),"\n",(0,c.jsx)(n.h3,{id:"2-dependency-direction",children:"2. Dependency Direction"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Quy t\u1eafc Dependency Direction"',children:"// \u2705 T\u1ed1t - Dependency t\u1eeb tr\xean xu\u1ed1ng d\u01b0\u1edbi\nDomain Layer \u2192 Application Layer \u2192 Infrastructure Layer\n\n// \u274c Kh\xf4ng t\u1ed1t - Dependency ng\u01b0\u1ee3c chi\u1ec1u\nInfrastructure Layer \u2192 Application Layer \u2192 Domain Layer\n"})}),"\n",(0,c.jsx)(n.h3,{id:"3-single-responsibility",children:"3. Single Responsibility"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Single Responsibility Principle"',children:"// \u2705 T\u1ed1t - M\u1ed7i service c\xf3 tr\xe1ch nhi\u1ec7m r\xf5 r\xe0ng\n@Injectable()\nexport class UserService {\n  // Ch\u1ec9 x\u1eed l\xfd user logic\n}\n\n@Injectable()\nexport class EmailService {\n  // Ch\u1ec9 x\u1eed l\xfd email logic\n}\n\n@Injectable()\nexport class NotificationService {\n  // Ch\u1ec9 x\u1eed l\xfd notification logic\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"testing-circular-dependency",children:"Testing Circular Dependency"}),"\n",(0,c.jsx)(n.h3,{id:"1-unit-test",children:"1. Unit Test"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Testing v\u1edbi Circular Dependency"',children:"describe('UserService', () => {\n  let service: UserService;\n  let emailService: EmailService;\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        UserService,\n        {\n          provide: EmailService,\n          useValue: {\n            sendWelcomeEmail: jest.fn()\n          }\n        }\n      ]\n    }).compile();\n\n    service = module.get<UserService>(UserService);\n    emailService = module.get<EmailService>(EmailService);\n  });\n\n  it('should create user and send email', async () => {\n    // Test logic\n  });\n});\n"})}),"\n",(0,c.jsx)(n.h3,{id:"2-integration-test",children:"2. Integration Test"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Integration Testing v\u1edbi Forward Reference"',children:"describe('User and Email Integration', () => {\n  let app: INestApplication;\n\n  beforeEach(async () => {\n    const moduleFixture: TestingModule = await Test.createTestingModule({\n      imports: [\n        forwardRef(() => UserModule),\n        forwardRef(() => EmailModule)\n      ]\n    }).compile();\n\n    app = moduleFixture.createNestApplication();\n    await app.init();\n  });\n\n  afterEach(async () => {\n    await app.close();\n  });\n\n  it('should handle user creation flow', async () => {\n    // Test integration\n  });\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"monitoring-v\xe0-debugging",children:"Monitoring v\xe0 Debugging"}),"\n",(0,c.jsx)(n.h3,{id:"1-dependency-graph",children:"1. Dependency Graph"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="T\u1ea1o Dependency Graph"',children:"// dependency-graph.service.ts\n@Injectable()\nexport class DependencyGraphService {\n  constructor(private moduleRef: ModuleRef) {}\n\n  generateDependencyGraph(): any {\n    const graph = {};\n    // Logic \u0111\u1ec3 t\u1ea1o dependency graph\n    return graph;\n  }\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"2-circular-dependency-detector",children:"2. Circular Dependency Detector"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",metastring:'title="Custom Circular Dependency Detector"',children:"// circular-dependency.detector.ts\nexport class CircularDependencyDetector {\n  static detect(providers: any[]): string[] {\n    const visited = new Set();\n    const recursionStack = new Set();\n    const circularDeps: string[] = [];\n\n    const dfs = (provider: any, path: string[]) => {\n      if (recursionStack.has(provider)) {\n        circularDeps.push(path.join(' \u2192 '));\n        return;\n      }\n\n      if (visited.has(provider)) return;\n\n      visited.add(provider);\n      recursionStack.add(provider);\n\n      // Ki\u1ec3m tra dependencies\n      // ... logic detection\n\n      recursionStack.delete(provider);\n    };\n\n    providers.forEach(provider => dfs(provider, [provider.name]));\n    return circularDeps;\n  }\n}\n"})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.admonition,{title:"\ud83d\udca1 L\u1eddi khuy\xean t\u1ed5ng k\u1ebft",type:"tip",children:(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Lu\xf4n \u01b0u ti\xean t\xe1i c\u1ea5u tr\xfac architecture"})," thay v\xec s\u1eed d\u1ee5ng forward reference"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"S\u1eed d\u1ee5ng Event Pattern"})," \u0111\u1ec3 gi\u1ea3m coupling gi\u1eefa c\xe1c service"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Thi\u1ebft k\u1ebf dependency direction"})," t\u1eeb domain \u2192 application \u2192 infrastructure"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Test k\u1ef9 l\u01b0\u1ee1ng"})," khi s\u1eed d\u1ee5ng forward reference"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Monitor dependency graph"})," \u0111\u1ec3 ph\xe1t hi\u1ec7n s\u1edbm v\u1ea5n \u0111\u1ec1"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Document r\xf5 r\xe0ng"})," c\xe1c dependency relationships"]}),"\n"]})}),"\n",(0,c.jsx)(n.admonition,{title:"\ud83d\udcda T\xe0i li\u1ec7u tham kh\u1ea3o",type:"info",children:(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://docs.nestjs.com/fundamentals/circular-dependency",children:"NestJS Circular Dependency Documentation"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://docs.nestjs.com/fundamentals/dependency-injection",children:"Dependency Injection Best Practices"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://docs.nestjs.com/fundamentals/module-ref",children:"Module Reference"})}),"\n"]})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"B\xe0i ti\u1ebfp theo:"})," ",(0,c.jsx)(n.a,{href:"/docs/tips/memory-leaks",children:"Memory Leaks trong NestJS"})]})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}}}]);