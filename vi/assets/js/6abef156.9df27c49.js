"use strict";(self.webpackChunktemplate_docs=self.webpackChunktemplate_docs||[]).push([[7877],{11470:(e,n,t)=>{t.d(n,{A:()=>A});var r=t(96540),i=t(34164),s=t(23104),c=t(56347),o=t(205),l=t(57485),d=t(31682),a=t(70679);function x(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return x(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function u({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const t=(0,c.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(i),(0,r.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})},[i,t])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,s=h(e),[c,l]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!u({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s})),[d,x]=p({queryString:t,groupId:i}),[g,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,i]=(0,a.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),m=(()=>{const e=d??g;return u({value:e,tabValues:s})?e:null})();(0,o.A)(()=>{m&&l(m)},[m]);return{selectedValue:c,selectValue:(0,r.useCallback)(e=>{if(!u({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),x(e),j(e)},[x,j,s]),tabValues:s}}var j=t(92303);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var E=t(74848);function y({className:e,block:n,selectedValue:t,selectValue:r,tabValues:c}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),d=e=>{const n=e.currentTarget,i=o.indexOf(n),s=c[i].value;s!==t&&(l(n),r(s))},a=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,E.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:c.map(({value:e,label:n,attributes:r})=>(0,E.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:a,onClick:d,...r,className:(0,i.A)("tabs__item",m.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function f({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,E.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function b(e){const n=g(e);return(0,E.jsxs)("div",{className:(0,i.A)("tabs-container",m.tabList),children:[(0,E.jsx)(y,{...n,...e}),(0,E.jsx)(f,{...n,...e})]})}function A(e){const n=(0,j.A)();return(0,E.jsx)(b,{...e,children:x(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>c});t(96540);var r=t(34164);const i={tabItem:"tabItem_Ymn6"};var s=t(74848);function c({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var r=t(96540);const i={},s=r.createContext(i);function c(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(s.Provider,{value:n},e.children)}},43023:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"ecom-co/libs/grpc/docs/grpc-exceptions","title":"gRPC Exceptions Library \u2014 Structured gRPC Error Classes","description":"Th\u01b0 vi\u1ec7n \u0111\u1ea7y \u0111\u1ee7 c\xe1c gRPC exception classes v\u1edbi status codes chu\u1ea9n, structured details v\xe0 utility functions.","source":"@site/docs/ecom-co/libs/grpc/docs/grpc-exceptions.md","sourceDirName":"ecom-co/libs/grpc/docs","slug":"/grpc-exceptions","permalink":"/document/vi/docs/grpc-exceptions","draft":false,"unlisted":false,"editUrl":"https://github.com/ecom-co/document/tree/main/docs/ecom-co/libs/grpc/docs/grpc-exceptions.md","tags":[{"inline":true,"label":"grpc","permalink":"/document/vi/docs/tags/grpc"},{"inline":true,"label":"exceptions","permalink":"/document/vi/docs/tags/exceptions"},{"inline":true,"label":"error-handling","permalink":"/document/vi/docs/tags/error-handling"},{"inline":true,"label":"status-codes","permalink":"/document/vi/docs/tags/status-codes"},{"inline":true,"label":"nestjs","permalink":"/document/vi/docs/tags/nestjs"}],"version":"current","frontMatter":{"id":"grpc-exceptions","title":"gRPC Exceptions Library \u2014 Structured gRPC Error Classes","sidebar_label":"gRPC Exceptions","slug":"/grpc-exceptions","description":"Th\u01b0 vi\u1ec7n \u0111\u1ea7y \u0111\u1ee7 c\xe1c gRPC exception classes v\u1edbi status codes chu\u1ea9n, structured details v\xe0 utility functions.","tags":["grpc","exceptions","error-handling","status-codes","nestjs"]},"sidebar":"tutorialSidebar","previous":{"title":"GrpcClientFilter","permalink":"/document/vi/docs/grpc-client-exception-filter"},"next":{"title":"RabbitMQ Library","permalink":"/document/vi/docs/ecom-co/libs/rabbitmq/rabbitmq-library"}}');var i=t(74848),s=t(28453),c=t(11470),o=t(19365);const l={id:"grpc-exceptions",title:"gRPC Exceptions Library \u2014 Structured gRPC Error Classes",sidebar_label:"gRPC Exceptions",slug:"/grpc-exceptions",description:"Th\u01b0 vi\u1ec7n \u0111\u1ea7y \u0111\u1ee7 c\xe1c gRPC exception classes v\u1edbi status codes chu\u1ea9n, structured details v\xe0 utility functions.",tags:["grpc","exceptions","error-handling","status-codes","nestjs"]},d=void 0,a={},x=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:3},{value:"GrpcStatusCodes Enum",id:"grpcstatuscodes-enum",level:3},{value:"Exception Classes",id:"exception-classes",level:3},{value:"Exception Classes Reference",id:"exception-classes-reference",level:3},{value:"Utility Functions",id:"utility-functions",level:3},{value:"Usage Patterns",id:"usage-patterns",level:3},{value:"Mermaid: Exception Hierarchy",id:"mermaid-exception-hierarchy",level:3},{value:"Best Practices",id:"best-practices",level:3}];function h(e){const n={admonition:"admonition",code:"code",h3:"h3",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Th\u01b0 vi\u1ec7n gRPC Exceptions cung c\u1ea5p t\u1ea5t c\u1ea3 exception classes theo gRPC status codes chu\u1ea9n, v\u1edbi structured details v\xe0 utility functions \u0111\u1ec3 error handling nh\u1ea5t qu\xe1n."})}),"\n",(0,i.jsx)(n.h3,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"BaseGrpcException"}),": Base class k\u1ebf th\u1eeba t\u1eeb ",(0,i.jsx)(n.code,{children:"RpcException"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GrpcStatusCodes"}),": Enum ch\u1ee9a t\u1ea5t c\u1ea3 gRPC status codes chu\u1ea9n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"15+ Exception Classes"}),": M\u1ed7i gRPC status code c\xf3 class ri\xeang"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Utility Functions"}),": Helper functions cho type checking v\xe0 conversion"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"grpcstatuscodes-enum",children:"GrpcStatusCodes Enum"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Code"}),(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"HTTP Equivalent"}),(0,i.jsx)(n.th,{children:"M\xf4 t\u1ea3"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"0"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"OK"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"200"}),(0,i.jsx)(n.td,{children:"Success"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"1"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CANCELLED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"499"}),(0,i.jsx)(n.td,{children:"Request cancelled by client"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"2"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UNKNOWN"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"500"}),(0,i.jsx)(n.td,{children:"Unknown error"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"3"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"INVALID_ARGUMENT"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"400"}),(0,i.jsx)(n.td,{children:"Invalid request parameters"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"4"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DEADLINE_EXCEEDED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"504"}),(0,i.jsx)(n.td,{children:"Request timeout"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"5"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NOT_FOUND"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"404"}),(0,i.jsx)(n.td,{children:"Resource not found"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"6"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ALREADY_EXISTS"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"409"}),(0,i.jsx)(n.td,{children:"Resource already exists"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"7"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PERMISSION_DENIED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"403"}),(0,i.jsx)(n.td,{children:"Access denied"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RESOURCE_EXHAUSTED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"429"}),(0,i.jsx)(n.td,{children:"Rate limit exceeded"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"9"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"FAILED_PRECONDITION"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"412"}),(0,i.jsx)(n.td,{children:"Precondition not met"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"10"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ABORTED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"409"}),(0,i.jsx)(n.td,{children:"Operation aborted"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"11"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"OUT_OF_RANGE"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"400"}),(0,i.jsx)(n.td,{children:"Value out of valid range"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"12"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UNIMPLEMENTED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"501"}),(0,i.jsx)(n.td,{children:"Method not implemented"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"13"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"INTERNAL"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"500"}),(0,i.jsx)(n.td,{children:"Internal server error"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"14"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UNAVAILABLE"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"503"}),(0,i.jsx)(n.td,{children:"Service unavailable"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"15"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DATA_LOSS"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"500"}),(0,i.jsx)(n.td,{children:"Data corruption detected"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"16"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UNAUTHENTICATED"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"401"}),(0,i.jsx)(n.td,{children:"Authentication required"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"exception-classes",children:"Exception Classes"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(o.A,{value:"validation",label:"Validation & Input Errors",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// GrpcValidationException - INVALID_ARGUMENT (3)\nthrow new GrpcValidationException('Validation failed', [\n    { field: 'email', message: 'Must be valid email' },\n    { field: 'age', message: 'Must be between 18-100' },\n]);\n\n// GrpcBadRequestException - INVALID_ARGUMENT (3)\nthrow new GrpcBadRequestException('Invalid request format', {\n    expectedFormat: 'JSON',\n    receivedFormat: 'XML',\n});\n\n// GrpcOutOfRangeException - OUT_OF_RANGE (11)\nthrow new GrpcOutOfRangeException('Page number out of range', {\n    min: 1,\n    max: 100,\n    actual: 150,\n});\n"})})}),(0,i.jsx)(o.A,{value:"auth",label:"Authentication & Authorization",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// GrpcUnauthorizedException - UNAUTHENTICATED (16)\nthrow new GrpcUnauthorizedException('Invalid token', 'Token expired');\n\n// GrpcForbiddenException - PERMISSION_DENIED (7)\nthrow new GrpcForbiddenException('Access denied', ['admin', 'user:write']);\n"})})}),(0,i.jsx)(o.A,{value:"resource",label:"Resource Management",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// GrpcNotFoundException - NOT_FOUND (5)\nthrow new GrpcNotFoundException('User not found', 'User');\n\n// GrpcConflictException - ALREADY_EXISTS (6)\nthrow new GrpcConflictException('Email already exists', 'user@example.com');\n\n// GrpcResourceExhaustedException - RESOURCE_EXHAUSTED (8)\nthrow new GrpcResourceExhaustedException('Rate limit exceeded', 'API calls', 1000, 1050);\n"})})}),(0,i.jsx)(o.A,{value:"operational",label:"Operational Errors",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// GrpcTimeoutException - DEADLINE_EXCEEDED (4)\nthrow new GrpcTimeoutException('Database query timeout', 5000);\n\n// GrpcUnavailableException - UNAVAILABLE (14)\nthrow new GrpcUnavailableException('Service maintenance', 3600); // retry after 1 hour\n\n// GrpcInternalException - INTERNAL (13)\nthrow new GrpcInternalException('Database connection failed', originalError);\n\n// GrpcAbortedException - ABORTED (10)\nthrow new GrpcAbortedException('Transaction rolled back', 'Concurrent modification');\n"})})}),(0,i.jsx)(o.A,{value:"implementation",label:"Implementation & Precondition",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// GrpcNotImplementedException - UNIMPLEMENTED (12)\nthrow new GrpcNotImplementedException('Feature not available', 'Advanced search');\n\n// GrpcFailedPreconditionException - FAILED_PRECONDITION (9)\nthrow new GrpcFailedPreconditionException('Account not verified', [\n    'Email verification required',\n    'Phone verification required',\n]);\n\n// GrpcCancelledException - CANCELLED (1)\nthrow new GrpcCancelledException('Operation cancelled by user');\n\n// GrpcDataLossException - DATA_LOSS (15)\nthrow new GrpcDataLossException('Data corruption detected in backup');\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"exception-classes-reference",children:"Exception Classes Reference"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Exception Class"}),(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"gRPC Code"}),(0,i.jsx)(n.th,{children:"Constructor Parameters"}),(0,i.jsx)(n.th,{children:"Details Structure"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcValidationException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"3"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, errors, field?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, count, errors, field? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcBadRequestException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"3"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, details?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, ...details }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcUnauthorizedException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"16"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, reason?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, reason? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcForbiddenException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"7"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, requiredPermissions?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, requiredPermissions? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcNotFoundException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"5"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, resource?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, resource? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcConflictException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"6"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, conflictingResource?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, conflictingResource? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcTimeoutException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"4"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, timeoutMs?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, timeoutMs? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcResourceExhaustedException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, resourceType?, limit?, current?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, resourceType?, limit?, current?, usage? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcInternalException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"13"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, cause?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, originalError?, stack? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcUnavailableException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"14"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, retryAfter?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, retryAfter? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcAbortedException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"10"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, reason?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, reason? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcNotImplementedException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"12"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, feature?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, feature? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcFailedPreconditionException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"9"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, requiredConditions?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, requiredConditions? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcOutOfRangeException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"11"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message, range?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, range? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcCancelledException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"1"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?, reason?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type, reason? }"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GrpcDataLossException"})}),(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"15"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(message?)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ type }"})})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"utility-functions",children:"Utility Functions"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(o.A,{value:"type-guards",label:"Type Guards & Checks",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { isGrpcException, BaseGrpcException } from '@ecom-co/grpc';\n\nfunction handleError(error: unknown) {\n    if (isGrpcException(error)) {\n        // error is BaseGrpcException | RpcException\n        console.log('gRPC Error:', error.getError());\n    } else {\n        console.log('Non-gRPC Error:', error);\n    }\n}\n\n// Check specific exception type\nfunction isNotFound(error: unknown): error is GrpcNotFoundException {\n    return error instanceof GrpcNotFoundException;\n}\n"})})}),(0,i.jsx)(o.A,{value:"conversion",label:"HTTP \u2192 gRPC Conversion",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { createGrpcExceptionFromHttp } from '@ecom-co/grpc';\n\n// Convert HTTP status codes to gRPC exceptions\nconst grpcError400 = createGrpcExceptionFromHttp(400, 'Bad request');\n// Returns: GrpcBadRequestException\n\nconst grpcError404 = createGrpcExceptionFromHttp(404, 'Not found');\n// Returns: GrpcNotFoundException\n\nconst grpcError500 = createGrpcExceptionFromHttp(500, 'Internal error');\n// Returns: GrpcInternalException\n\n// Usage trong HTTP \u2192 gRPC gateway\napp.use((req, res, next) => {\n    try {\n        // HTTP logic\n    } catch (error) {\n        if (error.status) {\n            throw createGrpcExceptionFromHttp(error.status, error.message);\n        }\n        throw error;\n    }\n});\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"usage-patterns",children:"Usage Patterns"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(o.A,{value:"service",label:"Service Implementation",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// user.service.ts\nimport { Injectable } from '@nestjs/common';\nimport {\n    GrpcNotFoundException,\n    GrpcConflictException,\n    GrpcValidationException,\n    GrpcInternalException,\n} from '@ecom-co/grpc';\n\n@Injectable()\nexport class UserService {\n    async findById(id: string) {\n        if (!id) {\n            throw new GrpcValidationException('User ID is required', [{ field: 'id', message: 'ID cannot be empty' }]);\n        }\n\n        const user = await this.repository.findById(id);\n        if (!user) {\n            throw new GrpcNotFoundException('User not found', 'User');\n        }\n\n        return user;\n    }\n\n    async createUser(data: CreateUserDto) {\n        // Check email uniqueness\n        const existing = await this.repository.findByEmail(data.email);\n        if (existing) {\n            throw new GrpcConflictException('User already exists', data.email);\n        }\n\n        try {\n            return await this.repository.create(data);\n        } catch (dbError) {\n            throw new GrpcInternalException('Failed to create user', dbError);\n        }\n    }\n\n    async deleteUser(id: string, currentUserId: string) {\n        if (id === currentUserId) {\n            throw new GrpcFailedPreconditionException('Cannot delete own account', [\n                'Use different account',\n                'Contact administrator',\n            ]);\n        }\n\n        const user = await this.findById(id); // May throw GrpcNotFoundException\n        await this.repository.delete(id);\n\n        return { success: true };\n    }\n}\n"})})}),(0,i.jsx)(o.A,{value:"middleware",label:"Error Handling Middleware",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// error-handling.middleware.ts\nimport { Injectable, NestMiddleware } from '@nestjs/common';\nimport { Request, Response, NextFunction } from 'express';\nimport { GrpcTimeoutException, GrpcResourceExhaustedException, isGrpcException } from '@ecom-co/grpc';\n\n@Injectable()\nexport class ErrorHandlingMiddleware implements NestMiddleware {\n    use(req: Request, res: Response, next: NextFunction) {\n        const startTime = Date.now();\n        const timeout = 30000; // 30 seconds\n\n        // Set timeout\n        const timeoutId = setTimeout(() => {\n            if (!res.headersSent) {\n                throw new GrpcTimeoutException('Request timeout', timeout);\n            }\n        }, timeout);\n\n        // Rate limiting check\n        const clientId = req.ip;\n        const requestCount = this.getRequestCount(clientId);\n        if (requestCount > 100) {\n            clearTimeout(timeoutId);\n            throw new GrpcResourceExhaustedException('Rate limit exceeded', 'Requests per minute', 100, requestCount);\n        }\n\n        res.on('finish', () => {\n            clearTimeout(timeoutId);\n        });\n\n        next();\n    }\n\n    private getRequestCount(clientId: string): number {\n        // Implementation for rate limiting\n        return 0;\n    }\n}\n"})})}),(0,i.jsx)(o.A,{value:"interceptor",label:"Logging Interceptor",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// grpc-logging.interceptor.ts\nimport { Injectable, NestInterceptor, ExecutionContext, CallHandler } from '@nestjs/common';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { isGrpcException } from '@ecom-co/grpc';\n\n@Injectable()\nexport class GrpcLoggingInterceptor implements NestInterceptor {\n    intercept(context: ExecutionContext, next: CallHandler): Observable<any> {\n        const rpcContext = context.switchToRpc();\n        const methodName = context.getHandler().name;\n        const data = rpcContext.getData();\n\n        console.log(`[gRPC] ${methodName} called with:`, data);\n\n        return next.handle().pipe(\n            tap((result) => {\n                console.log(`[gRPC] ${methodName} success:`, result);\n            }),\n            catchError((error) => {\n                if (isGrpcException(error)) {\n                    const grpcError = error.getError();\n                    console.error(`[gRPC] ${methodName} failed:`, {\n                        code: grpcError.code,\n                        message: grpcError.message,\n                        details: grpcError.details,\n                    });\n                } else {\n                    console.error(`[gRPC] ${methodName} unexpected error:`, error);\n                }\n                return throwError(() => error);\n            }),\n        );\n    }\n}\n"})})}),(0,i.jsx)(o.A,{value:"custom",label:"Custom Exception Classes",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// custom-exceptions.ts\nimport { BaseGrpcException, GrpcStatusCodes } from '@ecom-co/grpc';\n\n// Domain-specific exception\nexport class UserQuotaExceededException extends BaseGrpcException {\n  constructor(currentUsage: number, limit: number, quotaType: string = 'storage') {\n    super({\n      code: GrpcStatusCodes.RESOURCE_EXHAUSTED,\n      message: `${quotaType} quota exceeded: ${currentUsage}/${limit}`,\n      details: {\n        type: 'QUOTA_EXCEEDED',\n        quotaType,\n        currentUsage,\n        limit,\n        overageAmount: currentUsage - limit,\n      },\n    });\n  }\n}\n\n// Business logic exception\nexport class PaymentRequiredException extends BaseGrpcException {\n  constructor(requiredAmount: number, currency: string = 'USD') {\n    super({\n      code: GrpcStatusCodes.FAILED_PRECONDITION,\n      message: `Payment required: ${requiredAmount} ${currency}`,\n      details: {\n        type: 'PAYMENT_REQUIRED',\n        amount: requiredAmount,\n        currency,\n        paymentMethods: ['credit_card', 'paypal', 'bank_transfer'],\n      },\n    });\n  }\n}\n\n// Usage\nasync upgradeAccount(userId: string, plan: string) {\n  const user = await this.findById(userId);\n  const pricing = await this.getPricing(plan);\n\n  if (!user.paymentMethod) {\n    throw new PaymentRequiredException(pricing.amount, pricing.currency);\n  }\n\n  const currentUsage = await this.getStorageUsage(userId);\n  const newLimit = this.getStorageLimit(plan);\n\n  if (currentUsage > newLimit) {\n    throw new UserQuotaExceededException(currentUsage, newLimit, 'storage');\n  }\n\n  return this.processUpgrade(user, plan);\n}\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"mermaid-exception-hierarchy",children:"Mermaid: Exception Hierarchy"}),"\n",(0,i.jsx)(n.mermaid,{value:"classDiagram\n    class RpcException {\n        +getError()\n    }\n\n    class BaseGrpcException {\n        +code: GrpcStatusCodes\n        +message: string\n        +details?: object\n    }\n\n    class GrpcValidationException {\n        +errors: unknown[]\n        +field?: string\n    }\n\n    class GrpcNotFoundException {\n        +resource?: string\n    }\n\n    class GrpcConflictException {\n        +conflictingResource?: string\n    }\n\n    class GrpcInternalException {\n        +originalError?: string\n        +stack?: string\n    }\n\n    class OtherGrpcExceptions {\n        +Note: Additional custom exceptions\n        +can be extended from BaseGrpcException\n    }\n\n    RpcException <|-- BaseGrpcException\n    BaseGrpcException <|-- GrpcValidationException\n    BaseGrpcException <|-- GrpcNotFoundException\n    BaseGrpcException <|-- GrpcConflictException\n    BaseGrpcException <|-- GrpcInternalException\n    BaseGrpcException <|-- OtherGrpcExceptions"}),"\n",(0,i.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"S\u1eed d\u1ee5ng specific exception classes"})," thay v\xec generic ",(0,i.jsx)(n.code,{children:"RpcException"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Include meaningful details"})," trong exception constructor"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Custom exceptions"})," cho domain-specific errors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type guards"})," \u0111\u1ec3 handle different error types safely"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Structured logging"})," v\u1edbi exception details \u0111\u1ec3 debugging"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["K\u1ebft h\u1ee3p v\u1edbi ",(0,i.jsx)(n.code,{children:"GrpcExceptionFilter"})," \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng convert HTTP exceptions th\xe0nh gRPC exceptions!"]})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);