"use strict";(self.webpackChunktemplate_docs=self.webpackChunktemplate_docs||[]).push([[9160],{11470:(e,n,t)=>{t.d(n,{A:()=>b});var i=t(96540),r=t(34164),s=t(23104),a=t(56347),c=t(205),l=t(57485),o=t(31682),d=t(70679);function h(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:i}})=>({value:e,label:n,attributes:t,default:i}))}(t);return function(e){const n=(0,o.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const t=(0,a.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(r),(0,i.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,s=u(e),[a,l]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s})),[o,h]=m({queryString:t,groupId:r}),[g,x]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,d.Dv)(n);return[t,(0,i.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),j=(()=>{const e=o??g;return p({value:e,tabValues:s})?e:null})();(0,c.A)(()=>{j&&l(j)},[j]);return{selectedValue:a,selectValue:(0,i.useCallback)(e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),x(e)},[h,x,s]),tabValues:s}}var x=t(92303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(74848);function y({className:e,block:n,selectedValue:t,selectValue:i,tabValues:a}){const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),o=e=>{const n=e.currentTarget,r=c.indexOf(n),s=a[r].value;s!==t&&(l(n),i(s))},d=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:i})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{c.push(e)},onKeyDown:d,onClick:o,...i,className:(0,r.A)("tabs__item",j.tabItem,i?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function f({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===t);return e?(0,i.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function k(e){const n=g(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",j.tabList),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(f,{...n,...e})]})}function b(e){const n=(0,x.A)();return(0,v.jsx)(k,{...e,children:h(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var i=t(34164);const r={tabItem:"tabItem_Ymn6"};var s=t(74848);function a({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,i.A)(r.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var i=t(96540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}},34540:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ecom-co/libs/redis/docs/redis-facade","title":"RedisFacade \u2014 Advanced Redis Operations","description":"RedisFacade cung c\u1ea5p API cao c\u1ea5p cho Redis v\u1edbi c\xe1c t\xednh n\u0103ng nh\u01b0 caching, locking, rate limiting, batch operations v\xe0 health monitoring.","source":"@site/docs/ecom-co/libs/redis/docs/redis-facade.md","sourceDirName":"ecom-co/libs/redis/docs","slug":"/redis-facade","permalink":"/document/vi/docs/redis-facade","draft":false,"unlisted":false,"editUrl":"https://github.com/ecom-co/document/tree/main/docs/ecom-co/libs/redis/docs/redis-facade.md","tags":[{"inline":true,"label":"redis-facade","permalink":"/document/vi/docs/tags/redis-facade"},{"inline":true,"label":"caching","permalink":"/document/vi/docs/tags/caching"},{"inline":true,"label":"locking","permalink":"/document/vi/docs/tags/locking"},{"inline":true,"label":"rate-limiting","permalink":"/document/vi/docs/tags/rate-limiting"},{"inline":true,"label":"batch-operations","permalink":"/document/vi/docs/tags/batch-operations"},{"inline":true,"label":"health-monitoring","permalink":"/document/vi/docs/tags/health-monitoring"}],"version":"current","frontMatter":{"id":"redis-facade","title":"RedisFacade \u2014 Advanced Redis Operations","sidebar_label":"RedisFacade","slug":"/redis-facade","description":"RedisFacade cung c\u1ea5p API cao c\u1ea5p cho Redis v\u1edbi c\xe1c t\xednh n\u0103ng nh\u01b0 caching, locking, rate limiting, batch operations v\xe0 health monitoring.","tags":["redis-facade","caching","locking","rate-limiting","batch-operations","health-monitoring"]},"sidebar":"tutorialSidebar","previous":{"title":"Examples & Best Practices","permalink":"/document/vi/docs/redis-examples"},"next":{"title":"API Reference","permalink":"/document/vi/docs/redis-api-reference"}}');var r=t(74848),s=t(28453);t(11470),t(19365);const a={id:"redis-facade",title:"RedisFacade \u2014 Advanced Redis Operations",sidebar_label:"RedisFacade",slug:"/redis-facade",description:"RedisFacade cung c\u1ea5p API cao c\u1ea5p cho Redis v\u1edbi c\xe1c t\xednh n\u0103ng nh\u01b0 caching, locking, rate limiting, batch operations v\xe0 health monitoring.",tags:["redis-facade","caching","locking","rate-limiting","batch-operations","health-monitoring"]},c=void 0,l={},o=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:2},{value:"Ki\u1ebfn tr\xfac RedisFacade",id:"ki\u1ebfn-tr\xfac-redisfacade",level:2},{value:"Kh\u1edfi t\u1ea1o RedisFacade",id:"kh\u1edfi-t\u1ea1o-redisfacade",level:2},{value:"C\xe1ch 1: Inject qua DI",id:"c\xe1ch-1-inject-qua-di",level:3},{value:"C\xe1ch 2: T\u1ea1o tr\u1ef1c ti\u1ebfp t\u1eeb RedisService",id:"c\xe1ch-2-t\u1ea1o-tr\u1ef1c-ti\u1ebfp-t\u1eeb-redisservice",level:3},{value:"Caching Patterns",id:"caching-patterns",level:2},{value:"1. Cache-Aside Pattern",id:"1-cache-aside-pattern",level:3},{value:"2. Write-Through Pattern",id:"2-write-through-pattern",level:3},{value:"3. Write-Behind Pattern",id:"3-write-behind-pattern",level:3},{value:"Distributed Locking",id:"distributed-locking",level:2},{value:"Basic Lock",id:"basic-lock",level:3},{value:"Lock v\u1edbi Retry",id:"lock-v\u1edbi-retry",level:3},{value:"Lock v\u1edbi Function Wrapper",id:"lock-v\u1edbi-function-wrapper",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Fixed Window Rate Limiting",id:"fixed-window-rate-limiting",level:3},{value:"Sliding Window Rate Limiting",id:"sliding-window-rate-limiting",level:3},{value:"Multiple Rate Limits",id:"multiple-rate-limits",level:3},{value:"Batch Operations",id:"batch-operations",level:2},{value:"Execute Batch",id:"execute-batch",level:3},{value:"Multiple Get/Set",id:"multiple-getset",level:3},{value:"Hash Operations",id:"hash-operations",level:3},{value:"Health Monitoring",id:"health-monitoring",level:2},{value:"Basic Health Check",id:"basic-health-check",level:3},{value:"Deep Health Check",id:"deep-health-check",level:3},{value:"Circuit Breaker Status",id:"circuit-breaker-status",level:3},{value:"Statistics v\xe0 Monitoring",id:"statistics-v\xe0-monitoring",level:2},{value:"Cache Statistics",id:"cache-statistics",level:3},{value:"Local Statistics",id:"local-statistics",level:3},{value:"Key Statistics",id:"key-statistics",level:3},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Memoization",id:"memoization",level:3},{value:"Pattern Matching",id:"pattern-matching",level:3},{value:"Connection Management",id:"connection-management",level:3},{value:"Configuration",id:"configuration",level:2},{value:"RedisFacadeConfig",id:"redisfacadeconfig",level:3},{value:"Custom Configuration",id:"custom-configuration",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Performance Tips",id:"performance-tips",level:2}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"RedisFacade l\xe0 m\u1ed9t l\u1edbp wrapper cao c\u1ea5p cho Redis client, cung c\u1ea5p c\xe1c t\xednh n\u0103ng n\xe2ng cao nh\u01b0 caching patterns, distributed locking, rate limiting, v\xe0 health monitoring. N\xf3 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 \u0111\u01a1n gi\u1ea3n h\xf3a vi\u1ec7c s\u1eed d\u1ee5ng Redis trong \u1ee9ng d\u1ee5ng NestJS."})}),"\n",(0,r.jsx)(n.h2,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,r.jsx)(n.p,{children:"RedisFacade cung c\u1ea5p m\u1ed9t interface \u0111\u01a1n gi\u1ea3n v\xe0 m\u1ea1nh m\u1ebd cho c\xe1c thao t\xe1c Redis ph\u1ee9c t\u1ea1p:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Caching Patterns"}),": Cache-Aside, Write-Through, Write-Behind"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Distributed Locking"}),": V\u1edbi TTL v\xe0 retry mechanisms"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting"}),": Fixed window v\xe0 sliding window"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Batch Operations"}),": X\u1eed l\xfd nhi\u1ec1u operations c\xf9ng l\xfac"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Health Monitoring"}),": Circuit breaker v\xe0 connection health"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Statistics"}),": Hit rate, memory usage, performance metrics"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ki\u1ebfn-tr\xfac-redisfacade",children:"Ki\u1ebfn tr\xfac RedisFacade"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph TB\n    A[RedisFacade] --\x3e B[Circuit Breaker]\n    A --\x3e C[Connection Health]\n    A --\x3e D[Statistics]\n    A --\x3e E[Core Operations]\n    A --\x3e F[Advanced Features]\n\n    B --\x3e B1[Failure Tracking]\n    B --\x3e B2[Timeout Management]\n\n    C --\x3e C1[Connection Status]\n    C --\x3e C2[Reconnection Attempts]\n\n    D --\x3e D1[Cache Hit/Miss]\n    D --\x3e D2[Memory Usage]\n    D --\x3e D3[Operation Count]\n\n    E --\x3e E1[Basic CRUD]\n    E --\x3e E2[Hash Operations]\n    E --\x3e E3[List Operations]\n    E --\x3e E4[Set Operations]\n    E --\x3e E5[Sorted Set Operations]\n\n    F --\x3e F1[Distributed Locks]\n    F --\x3e F2[Rate Limiting]\n    F --\x3e F3[Caching Patterns]\n    F --\x3e F4[Batch Operations]"}),"\n",(0,r.jsx)(n.h2,{id:"kh\u1edfi-t\u1ea1o-redisfacade",children:"Kh\u1edfi t\u1ea1o RedisFacade"}),"\n",(0,r.jsx)(n.h3,{id:"c\xe1ch-1-inject-qua-di",children:"C\xe1ch 1: Inject qua DI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Injectable } from '@nestjs/common';\nimport { InjectRedisFacade } from '@ecom-co/redis';\nimport { RedisFacade } from '@ecom-co/redis';\n\n@Injectable()\nexport class CacheService {\n    constructor(\n        @InjectRedisFacade() private readonly cache: RedisFacade,\n        @InjectRedisFacade('session') private readonly session: RedisFacade,\n    ) {}\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"c\xe1ch-2-t\u1ea1o-tr\u1ef1c-ti\u1ebfp-t\u1eeb-redisservice",children:"C\xe1ch 2: T\u1ea1o tr\u1ef1c ti\u1ebfp t\u1eeb RedisService"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Injectable } from '@nestjs/common';\nimport { RedisService } from '@ecom-co/redis';\n\n@Injectable()\nexport class CacheService {\n    private readonly cache: RedisFacade;\n    private readonly userCache: RedisFacade;\n\n    constructor(private readonly redisService: RedisService) {\n        this.cache = this.redisService.use('default', 'app:');\n        this.userCache = this.redisService.use('default', 'user:');\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"caching-patterns",children:"Caching Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"1-cache-aside-pattern",children:"1. Cache-Aside Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async getUser(id: number) {\n  return await this.cache.cacheAside(\n    `user:${id}`,\n    async () => {\n      // Load t\u1eeb database\n      return await this.userRepository.findById(id);\n    },\n    {\n      ttlSeconds: 3600, // 1 gi\u1edd\n      refreshThreshold: 0.8, // Refresh khi 80% TTL \u0111\xe3 qua\n    }\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-write-through-pattern",children:"2. Write-Through Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async updateUser(id: number, data: UserUpdateDto) {\n  await this.cache.writeThrough(\n    `user:${id}`,\n    data,\n    async (userData) => {\n      // L\u01b0u v\xe0o database\n      await this.userRepository.update(id, userData);\n    },\n    { ttlSeconds: 3600 }\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-write-behind-pattern",children:"3. Write-Behind Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async createUser(data: CreateUserDto) {\n  await this.cache.writeBehind(\n    `user:${data.id}`,\n    data,\n    async (userData) => {\n      // L\u01b0u v\xe0o database (async)\n      await this.userRepository.create(userData);\n    },\n    { ttlSeconds: 3600 }\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"distributed-locking",children:"Distributed Locking"}),"\n",(0,r.jsx)(n.h3,{id:"basic-lock",children:"Basic Lock"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async processOrder(orderId: string) {\n  const lock = await this.cache.acquireLock(`order:${orderId}`, 30000);\n\n  if (!lock.ok) {\n    throw new Error('Kh\xf4ng th\u1ec3 acquire lock cho order');\n  }\n\n  try {\n    // X\u1eed l\xfd order\n    await this.processOrderLogic(orderId);\n  } finally {\n    // Lu\xf4n release lock\n    await lock.release();\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"lock-v\u1edbi-retry",children:"Lock v\u1edbi Retry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async processOrderWithRetry(orderId: string) {\n  const lock = await this.cache.acquireLockWithRetry(\n    `order:${orderId}`,\n    30000, // TTL\n    5,     // Max retries\n    100    // Retry delay (ms)\n  );\n\n  if (!lock.ok) {\n    throw new Error('Kh\xf4ng th\u1ec3 acquire lock sau nhi\u1ec1u l\u1ea7n th\u1eed');\n  }\n\n  try {\n    await this.processOrderLogic(orderId);\n  } finally {\n    await lock.release();\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"lock-v\u1edbi-function-wrapper",children:"Lock v\u1edbi Function Wrapper"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async processOrder(orderId: string) {\n  return await this.cache.withLock(\n    `order:${orderId}`,\n    30000,\n    async () => {\n      // Function n\xe0y ch\u1ec9 ch\u1ea1y khi c\xf3 lock\n      return await this.processOrderLogic(orderId);\n    },\n    { maxRetries: 3, retryDelayMs: 100 }\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,r.jsx)(n.h3,{id:"fixed-window-rate-limiting",children:"Fixed Window Rate Limiting"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async checkRateLimit(userId: string) {\n  const result = await this.cache.rateLimit(\n    `user:${userId}`,\n    100,    // Max requests\n    60000   // Window (1 ph\xfat)\n  );\n\n  if (!result.allowed) {\n    throw new Error(`Rate limit exceeded. Retry after ${result.retryAfter}ms`);\n  }\n\n  return result.remaining; // S\u1ed1 requests c\xf2n l\u1ea1i\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sliding-window-rate-limiting",children:"Sliding Window Rate Limiting"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async checkSlidingRateLimit(userId: string) {\n  const result = await this.cache.slidingWindowRateLimit(\n    `user:${userId}`,\n    100,    // Max requests\n    60000   // Window (1 ph\xfat)\n  );\n\n  if (!result.allowed) {\n    throw new Error('Rate limit exceeded');\n  }\n\n  return result.remaining;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-rate-limits",children:"Multiple Rate Limits"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async checkMultipleRateLimits(userId: string, ip: string) {\n  const results = await this.cache.rateLimitMultiple([\n    { key: `user:${userId}`, limit: 100, windowMs: 60000 },\n    { key: `ip:${ip}`, limit: 1000, windowMs: 60000 },\n  ]);\n\n  const userLimit = results[0];\n  const ipLimit = results[1];\n\n  if (!userLimit.allowed || !ipLimit.allowed) {\n    throw new Error('Rate limit exceeded');\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"batch-operations",children:"Batch Operations"}),"\n",(0,r.jsx)(n.h3,{id:"execute-batch",children:"Execute Batch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async processBatchOperations() {\n  const operations = [\n    { operation: 'set', key: 'key1', value: 'value1' },\n    { operation: 'get', key: 'key2' },\n    { operation: 'incr', key: 'counter', amount: 5 },\n    { operation: 'del', key: 'temp:key' },\n  ];\n\n  const results = await this.cache.executeBatch(operations);\n  return results;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-getset",children:"Multiple Get/Set"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Get nhi\u1ec1u keys\nconst users = await this.cache.mget<User>(['user:1', 'user:2', 'user:3']);\n\n// Set nhi\u1ec1u key-value pairs\nawait this.cache.mset([\n    { key: 'user:1', value: { id: 1, name: 'John' } },\n    { key: 'user:2', value: { id: 2, name: 'Jane' } },\n    { key: 'counter', value: 42, options: { ttlSeconds: 3600 } },\n]);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hash-operations",children:"Hash Operations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Set multiple hash fields\nawait this.cache.hmsetObject('user:1', {\n    name: 'John Doe',\n    email: 'john@example.com',\n    age: 30,\n});\n\n// Get multiple hash fields\nconst userData = await this.cache.hmgetObject<{\n    name: string;\n    email: string;\n    age: number;\n}>('user:1', ['name', 'email', 'age']);\n\n// Set multiple hashes\nawait this.cache.hmsetMultiple([\n    { key: 'user:1', obj: { name: 'John', score: 100 } },\n    { key: 'user:2', obj: { name: 'Jane', score: 95 } },\n]);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"health-monitoring",children:"Health Monitoring"}),"\n",(0,r.jsx)(n.h3,{id:"basic-health-check",children:"Basic Health Check"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async checkHealth() {\n  const health = await this.cache.healthCheck();\n\n  if (health.status === 'healthy') {\n    console.log(`Redis healthy (${health.latency}ms)`);\n  } else {\n    console.error('Redis unhealthy:', health.error);\n  }\n\n  return health;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deep-health-check",children:"Deep Health Check"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async deepHealthCheck() {\n  const report = await this.cache.deepHealthCheck();\n\n  console.log('Overall status:', report.status);\n  console.log('Circuit breaker:', report.circuitBreakerStatus);\n  console.log('Connection health:', report.connectionHealth);\n\n  // Ki\u1ec3m tra t\u1eebng test case\n  Object.entries(report.checks).forEach(([test, result]) => {\n    console.log(`${test}: ${result.ok ? 'PASS' : 'FAIL'}`);\n  });\n\n  return report;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"circuit-breaker-status",children:"Circuit Breaker Status"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async getCircuitBreakerInfo() {\n  const status = this.cache.getCircuitBreakerStatus();\n\n  if (status.isOpen) {\n    console.warn(`Circuit breaker is OPEN. Next attempt: ${status.nextAttempt}`);\n  } else {\n    console.log(`Circuit breaker is CLOSED. Failures: ${status.failures}`);\n  }\n\n  return status;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"statistics-v\xe0-monitoring",children:"Statistics v\xe0 Monitoring"}),"\n",(0,r.jsx)(n.h3,{id:"cache-statistics",children:"Cache Statistics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async getCacheStats() {\n  const stats = await this.cache.getCacheStats();\n\n  console.log(`Hit Rate: ${stats.hitRate}%`);\n  console.log(`Miss Rate: ${stats.missRate}%`);\n  console.log(`Total Keys: ${stats.totalKeys}`);\n  console.log(`Memory Usage: ${stats.memoryUsage}`);\n  console.log(`Total Requests: ${stats.totalRequests}`);\n\n  return stats;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"local-statistics",children:"Local Statistics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const localStats = this.cache.getLocalStats();\nconsole.log(`Local Hit Rate: ${localStats.hitRate}%`);\nconsole.log(`Local Error Rate: ${localStats.errorRate}%`);\n\n// Reset stats\nthis.cache.resetStats();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"key-statistics",children:"Key Statistics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async getKeyStats() {\n  const keyStats = await this.cache.getKeyStats('user:*');\n\n  keyStats.forEach(stat => {\n    console.log(`${stat.key}: ${stat.type}, TTL: ${stat.ttl}s`);\n  });\n\n  return keyStats;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,r.jsx)(n.h3,{id:"memoization",children:"Memoization"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// T\u1ea1o memoized function\nconst memoizedFetchUser = this.cache.memoize(\n    async (id: number) => {\n        return await this.userRepository.findById(id);\n    },\n    (id: number) => `user:${id}`,\n    3600, // TTL 1 gi\u1edd\n);\n\n// S\u1eed d\u1ee5ng\nconst user1 = await memoizedFetchUser(1);\nconst user2 = await memoizedFetchUser(2);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-matching",children:"Pattern Matching"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// T\xecm keys theo pattern\nconst userKeys = await this.cache.findKeysByPattern('user:*');\nconst sessionKeys = await this.cache.getKeysByPrefix('session:');\n\n// Group keys theo patterns\nconst groupedKeys = await this.cache.groupKeysByPattern(['user:*', 'session:*', 'temp:*']);\n\n// X\xf3a keys theo pattern\nconst deletedCount = await this.cache.deleteKeysByPattern('temp:*');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"connection-management",children:"Connection Management"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Ki\u1ec3m tra connection health\nconst connectionHealth = this.cache.getConnectionHealth();\nconsole.log('Connected:', connectionHealth.isConnected);\nconsole.log('Reconnect attempts:', connectionHealth.reconnectAttempts);\n\n// Reset circuit breaker\nthis.cache.resetCircuitBreaker();\n\n// Dispose resources\nthis.cache.dispose();\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"redisfacadeconfig",children:"RedisFacadeConfig"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bulkOperationChunkSize"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1000"})}),(0,r.jsx)(n.td,{children:"K\xedch th\u01b0\u1edbc chunk cho bulk operations"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"circuitBreakerThreshold"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:"S\u1ed1 l\u1ea7n fail tr\u01b0\u1edbc khi m\u1edf circuit breaker"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"circuitBreakerTimeout"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"60000"})}),(0,r.jsx)(n.td,{children:"Th\u1eddi gian timeout cho circuit breaker (ms)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lockDefaultTtl"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30000"})}),(0,r.jsx)(n.td,{children:"TTL m\u1eb7c \u0111\u1ecbnh cho locks (ms)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"maxRetries"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3"})}),(0,r.jsx)(n.td,{children:"S\u1ed1 l\u1ea7n retry t\u1ed1i \u0111a"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"retryDelay"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"100"})}),(0,r.jsx)(n.td,{children:"Delay gi\u1eefa c\xe1c l\u1ea7n retry (ms)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"scanCount"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1000"})}),(0,r.jsx)(n.td,{children:"S\u1ed1 keys scan m\u1ed7i l\u1ea7n"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"statsFlushInterval"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5000"})}),(0,r.jsx)(n.td,{children:"Interval flush stats (ms)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"custom-configuration",children:"Custom Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const customConfig = {\n    bulkOperationChunkSize: 500,\n    circuitBreakerThreshold: 3,\n    lockDefaultTtl: 60000,\n    maxRetries: 5,\n    retryDelay: 200,\n};\n\nconst facade = new RedisFacade(redisClient, 'app:', customConfig);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"S\u1eed d\u1ee5ng key prefix"}),": Lu\xf4n s\u1eed d\u1ee5ng key prefix \u0111\u1ec3 tr\xe1nh conflict gi\u1eefa c\xe1c module kh\xe1c nhau."]})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Handle errors gracefully"}),": Lu\xf4n wrap Redis operations trong try-catch v\xe0 c\xf3 fallback strategy."]})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Monitor performance"}),": S\u1eed d\u1ee5ng health checks v\xe0 statistics \u0111\u1ec3 monitor Redis performance."]})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Circuit Breaker"}),": Kh\xf4ng disable circuit breaker trong production. N\xf3 b\u1ea3o v\u1ec7 \u1ee9ng d\u1ee5ng kh\u1ecfi Redis failures."]})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Memory Usage"}),": Monitor memory usage \u0111\u1ec3 tr\xe1nh Redis memory overflow."]})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async safeOperation() {\n  try {\n    return await this.cache.get('key');\n  } catch (error) {\n    if (error.message.includes('Circuit breaker is open')) {\n      // Fallback to database\n      return await this.databaseFallback();\n    }\n\n    if (error.message.includes('Connection failed')) {\n      // Retry logic\n      return await this.retryOperation();\n    }\n\n    throw error;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Batch Operations"}),": S\u1eed d\u1ee5ng ",(0,r.jsx)(n.code,{children:"mget"}),", ",(0,r.jsx)(n.code,{children:"mset"}),", ",(0,r.jsx)(n.code,{children:"executeBatch"})," thay v\xec multiple single operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pipeline"}),": S\u1eed d\u1ee5ng ",(0,r.jsx)(n.code,{children:"pipeline()"})," cho complex operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key Design"}),": Thi\u1ebft k\u1ebf keys h\u1ee3p l\xfd \u0111\u1ec3 t\u1ed1i \u01b0u memory usage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"TTL Management"}),": Lu\xf4n set TTL cho temporary data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitoring"}),": S\u1eed d\u1ee5ng health checks \u0111\u1ec3 detect issues s\u1edbm"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);